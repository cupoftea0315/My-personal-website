<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="TC-tea">

<title>ENV222 NOTE</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="ENV222 note_files/libs/clipboard/clipboard.min.js"></script>
<script src="ENV222 note_files/libs/quarto-html/quarto.js"></script>
<script src="ENV222 note_files/libs/quarto-html/popper.min.js"></script>
<script src="ENV222 note_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="ENV222 note_files/libs/quarto-html/anchor.min.js"></script>
<link href="ENV222 note_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="ENV222 note_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="ENV222 note_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="ENV222 note_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="ENV222 note_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#r-markdown-syntax" id="toc-r-markdown-syntax" class="nav-link active" data-scroll-target="#r-markdown-syntax"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>1</strong></span> R-markdown syntax</a>
  <ul class="collapse">
  <li><a href="#fundamental" id="toc-fundamental" class="nav-link" data-scroll-target="#fundamental"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>1.1</strong></span> Fundamental</a></li>
  <li><a href="#advanced" id="toc-advanced" class="nav-link" data-scroll-target="#advanced"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>1.2</strong></span> Advanced</a></li>
  </ul></li>
  <li><a href="#basic-r-charaters" id="toc-basic-r-charaters" class="nav-link" data-scroll-target="#basic-r-charaters"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2</strong></span> Basic R charaters</a>
  <ul class="collapse">
  <li><a href="#check-the-data-type" id="toc-check-the-data-type" class="nav-link" data-scroll-target="#check-the-data-type"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2.1</strong></span> Check the data type</a></li>
  <li><a href="#index-to-maximum-and-minimum-values" id="toc-index-to-maximum-and-minimum-values" class="nav-link" data-scroll-target="#index-to-maximum-and-minimum-values"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2.2</strong></span> Index to maximum and minimum values</a></li>
  <li><a href="#capital-and-small-letter" id="toc-capital-and-small-letter" class="nav-link" data-scroll-target="#capital-and-small-letter"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2.3</strong></span> Capital and small letter</a></li>
  <li><a href="#split-string" id="toc-split-string" class="nav-link" data-scroll-target="#split-string"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2.4</strong></span> Split string</a></li>
  <li><a href="#separate-column" id="toc-separate-column" class="nav-link" data-scroll-target="#separate-column"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2.5</strong></span> Separate column</a></li>
  <li><a href="#extract" id="toc-extract" class="nav-link" data-scroll-target="#extract"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2.6</strong></span> Extract</a></li>
  <li><a href="#connect" id="toc-connect" class="nav-link" data-scroll-target="#connect"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2.7</strong></span> Connect</a></li>
  <li><a href="#find" id="toc-find" class="nav-link" data-scroll-target="#find"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2.8</strong></span> Find</a></li>
  <li><a href="#replace" id="toc-replace" class="nav-link" data-scroll-target="#replace"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2.9</strong></span> Replace</a></li>
  <li><a href="#regular-expression" id="toc-regular-expression" class="nav-link" data-scroll-target="#regular-expression"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2.10</strong></span> <span style="color:orange">Regular expression</span></a></li>
  </ul></li>
  <li><a href="#time-data-in-r" id="toc-time-data-in-r" class="nav-link" data-scroll-target="#time-data-in-r"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>3</strong></span> Time data in R</a>
  <ul class="collapse">
  <li><a href="#format-of-time" id="toc-format-of-time" class="nav-link" data-scroll-target="#format-of-time"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>3.1</strong></span> Format of time</a></li>
  <li><a href="#numeric-of-date" id="toc-numeric-of-date" class="nav-link" data-scroll-target="#numeric-of-date"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>3.2</strong></span> Numeric of date</a>
  <ul class="collapse">
  <li><a href="#time-format-codes" id="toc-time-format-codes" class="nav-link" data-scroll-target="#time-format-codes"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>3.2.1</strong></span> Time format codes</a></li>
  </ul></li>
  <li><a href="#calculating-date" id="toc-calculating-date" class="nav-link" data-scroll-target="#calculating-date"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>3.3</strong></span> Calculating date</a></li>
  <li><a href="#set-time-zone-calculation" id="toc-set-time-zone-calculation" class="nav-link" data-scroll-target="#set-time-zone-calculation"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>3.4</strong></span> Set time zone &amp; calculation</a></li>
  </ul></li>
  <li><a href="#latex" id="toc-latex" class="nav-link" data-scroll-target="#latex"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>4</strong></span> <span style="color:orange">LaTeX</span></a>
  <ul class="collapse">
  <li><a href="#fundamental-1" id="toc-fundamental-1" class="nav-link" data-scroll-target="#fundamental-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>4.1</strong></span> Fundamental</a></li>
  <li><a href="#advanced-1" id="toc-advanced-1" class="nav-link" data-scroll-target="#advanced-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>4.2</strong></span> Advanced</a></li>
  </ul></li>
  <li><a href="#r-graph-advanced" id="toc-r-graph-advanced" class="nav-link" data-scroll-target="#r-graph-advanced"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>5</strong></span> R graph (advanced)</a>
  <ul class="collapse">
  <li><a href="#r-graph-advanceddifferent-theme-of-plot" id="toc-r-graph-advanceddifferent-theme-of-plot" class="nav-link" data-scroll-target="#r-graph-advanceddifferent-theme-of-plot"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>5.1</strong></span> R graph (advanced)Different theme of plot</a></li>
  <li><a href="#r-graph-advancedmath-formulas-with-r" id="toc-r-graph-advancedmath-formulas-with-r" class="nav-link" data-scroll-target="#r-graph-advancedmath-formulas-with-r"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>5.2</strong></span> R graph (advanced)Math formulas with R</a></li>
  <li><a href="#r-graph-advancedsize-and-layout" id="toc-r-graph-advancedsize-and-layout" class="nav-link" data-scroll-target="#r-graph-advancedsize-and-layout"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>5.3</strong></span> R graph (advanced)Size and layout</a></li>
  </ul></li>
  <li><a href="#r-tidyverse" id="toc-r-tidyverse" class="nav-link" data-scroll-target="#r-tidyverse"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>6</strong></span> R Tidyverse</a>
  <ul class="collapse">
  <li><a href="#workflow" id="toc-workflow" class="nav-link" data-scroll-target="#workflow"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>6.1</strong></span> Workflow</a></li>
  <li><a href="#fundamental-operations" id="toc-fundamental-operations" class="nav-link" data-scroll-target="#fundamental-operations"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>6.2</strong></span> Fundamental operations</a></li>
  <li><a href="#pipe-operator" id="toc-pipe-operator" class="nav-link" data-scroll-target="#pipe-operator"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>6.3</strong></span> Pipe operator</a></li>
  <li><a href="#mutiply-work-by-using-tidyverse-pipe" id="toc-mutiply-work-by-using-tidyverse-pipe" class="nav-link" data-scroll-target="#mutiply-work-by-using-tidyverse-pipe"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>6.4</strong></span> Mutiply work by using tidyverse pipe</a>
  <ul class="collapse">
  <li><a href="#graph-work" id="toc-graph-work" class="nav-link" data-scroll-target="#graph-work"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>6.4.1</strong></span> Graph work</a></li>
  <li><a href="#statistic-work" id="toc-statistic-work" class="nav-link" data-scroll-target="#statistic-work"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>6.4.2</strong></span> Statistic work</a></li>
  </ul></li>
  <li><a href="#tidy-the-dataset" id="toc-tidy-the-dataset" class="nav-link" data-scroll-target="#tidy-the-dataset"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>6.5</strong></span> Tidy the dataset</a></li>
  <li><a href="#conversions-the-dataframe-type" id="toc-conversions-the-dataframe-type" class="nav-link" data-scroll-target="#conversions-the-dataframe-type"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>6.6</strong></span> Conversions the dataframe type</a></li>
  <li><a href="#find-missing-observations" id="toc-find-missing-observations" class="nav-link" data-scroll-target="#find-missing-observations"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>6.7</strong></span> Find missing observations</a></li>
  </ul></li>
  <li><a href="#anova-post-hoc-tests" id="toc-anova-post-hoc-tests" class="nav-link" data-scroll-target="#anova-post-hoc-tests"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>7</strong></span> ANOVA (Post-hoc tests)</a>
  <ul class="collapse">
  <li><a href="#post-hoc-tests" id="toc-post-hoc-tests" class="nav-link" data-scroll-target="#post-hoc-tests"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>7.1</strong></span> Post-hoc tests</a></li>
  <li><a href="#fishers-least-significant-difference-lsd-test" id="toc-fishers-least-significant-difference-lsd-test" class="nav-link" data-scroll-target="#fishers-least-significant-difference-lsd-test"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>7.2</strong></span> Fisher’s Least Significant Difference (LSD) Test</a>
  <ul class="collapse">
  <li><a href="#concept" id="toc-concept" class="nav-link" data-scroll-target="#concept"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>7.2.1</strong></span> Concept</a></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>7.2.2</strong></span> Example</a></li>
  </ul></li>
  <li><a href="#bonferroni-t-test" id="toc-bonferroni-t-test" class="nav-link" data-scroll-target="#bonferroni-t-test"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>7.3</strong></span> Bonferroni t-test</a>
  <ul class="collapse">
  <li><a href="#concept-1" id="toc-concept-1" class="nav-link" data-scroll-target="#concept-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>7.3.1</strong></span> Concept</a></li>
  <li><a href="#example-1" id="toc-example-1" class="nav-link" data-scroll-target="#example-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>7.3.2</strong></span> Example</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#manova" id="toc-manova" class="nav-link" data-scroll-target="#manova"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8</strong></span> MANOVA</a>
  <ul class="collapse">
  <li><a href="#definition-of-manova" id="toc-definition-of-manova" class="nav-link" data-scroll-target="#definition-of-manova"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.1</strong></span> Definition of MANOVA</a></li>
  <li><a href="#coding-and-visualization" id="toc-coding-and-visualization" class="nav-link" data-scroll-target="#coding-and-visualization"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.2</strong></span> Coding and visualization</a></li>
  <li><a href="#one-way-manova" id="toc-one-way-manova" class="nav-link" data-scroll-target="#one-way-manova"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.3</strong></span> One-way MANOVA</a></li>
  <li><a href="#post-hoc-test" id="toc-post-hoc-test" class="nav-link" data-scroll-target="#post-hoc-test"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.4</strong></span> Post-hoc test</a></li>
  <li><a href="#multivariate-normality" id="toc-multivariate-normality" class="nav-link" data-scroll-target="#multivariate-normality"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.5</strong></span> Multivariate normality</a>
  <ul class="collapse">
  <li><a href="#shapiro-wilk-test" id="toc-shapiro-wilk-test" class="nav-link" data-scroll-target="#shapiro-wilk-test"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.5.1</strong></span> Shapiro-Wilk test</a></li>
  <li><a href="#mardias-skewness-and-kurtosis-test" id="toc-mardias-skewness-and-kurtosis-test" class="nav-link" data-scroll-target="#mardias-skewness-and-kurtosis-test"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.5.2</strong></span> Mardia’s skewness and kurtosis test</a></li>
  <li><a href="#homogeneity-of-the-variance-covariance-matrix" id="toc-homogeneity-of-the-variance-covariance-matrix" class="nav-link" data-scroll-target="#homogeneity-of-the-variance-covariance-matrix"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.5.3</strong></span> Homogeneity of the variance-covariance matrix</a></li>
  <li><a href="#multivariate-outliers" id="toc-multivariate-outliers" class="nav-link" data-scroll-target="#multivariate-outliers"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.5.4</strong></span> Multivariate outliers</a></li>
  <li><a href="#linearity" id="toc-linearity" class="nav-link" data-scroll-target="#linearity"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.5.5</strong></span> Linearity</a></li>
  <li><a href="#multicollinearity" id="toc-multicollinearity" class="nav-link" data-scroll-target="#multicollinearity"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.5.6</strong></span> Multicollinearity</a></li>
  </ul></li>
  <li><a href="#two-way-manova" id="toc-two-way-manova" class="nav-link" data-scroll-target="#two-way-manova"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.6</strong></span> Two-way MANOVA</a></li>
  </ul></li>
  <li><a href="#ancova" id="toc-ancova" class="nav-link" data-scroll-target="#ancova"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9</strong></span> ANCOVA</a>
  <ul class="collapse">
  <li><a href="#definition-of-ancova" id="toc-definition-of-ancova" class="nav-link" data-scroll-target="#definition-of-ancova"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.1</strong></span> Definition of ANCOVA</a></li>
  <li><a href="#one-way-ancova" id="toc-one-way-ancova" class="nav-link" data-scroll-target="#one-way-ancova"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.2</strong></span> One-way ANCOVA</a>
  <ul class="collapse">
  <li><a href="#question" id="toc-question" class="nav-link" data-scroll-target="#question"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.2.1</strong></span> Question</a></li>
  <li><a href="#maximal-model" id="toc-maximal-model" class="nav-link" data-scroll-target="#maximal-model"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.2.2</strong></span> Maximal model</a></li>
  <li><a href="#minimal-model" id="toc-minimal-model" class="nav-link" data-scroll-target="#minimal-model"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.2.3</strong></span> Minimal model</a></li>
  <li><a href="#one-step" id="toc-one-step" class="nav-link" data-scroll-target="#one-step"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.2.4</strong></span> One step</a></li>
  <li><a href="#result" id="toc-result" class="nav-link" data-scroll-target="#result"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.2.5</strong></span> Result</a></li>
  </ul></li>
  <li><a href="#two-way-ancova" id="toc-two-way-ancova" class="nav-link" data-scroll-target="#two-way-ancova"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.3</strong></span> Two-way ANCOVA</a>
  <ul class="collapse">
  <li><a href="#question-1" id="toc-question-1" class="nav-link" data-scroll-target="#question-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.3.1</strong></span> Question</a></li>
  <li><a href="#model" id="toc-model" class="nav-link" data-scroll-target="#model"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.3.2</strong></span> Model</a></li>
  <li><a href="#one-step-1" id="toc-one-step-1" class="nav-link" data-scroll-target="#one-step-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.3.3</strong></span> One step</a></li>
  <li><a href="#result-1" id="toc-result-1" class="nav-link" data-scroll-target="#result-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.3.4</strong></span> Result</a></li>
  <li><a href="#visualization" id="toc-visualization" class="nav-link" data-scroll-target="#visualization"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.3.5</strong></span> Visualization</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#mancova" id="toc-mancova" class="nav-link" data-scroll-target="#mancova"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>10</strong></span> MANCOVA</a></li>
  <li><a href="#sessioninfo" id="toc-sessioninfo" class="nav-link" data-scroll-target="#sessioninfo"><span style="color:green">SessionInfo:</span></a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><strong>ENV222 NOTE</strong></h1>
<p class="subtitle lead"><em>R in statistics (Advanced)</em></p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>TC-tea </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">2023.04.04</p>
    </div>
  </div>
  
    
  </div>
  

</header>


<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
    body {
      background-color: white;
      color: black;
    }
    .dark-mode {
      background-color: black;
      color: white;
    }
    /* Add this CSS */
    #myBtn {
      position: fixed;
      top: 20px;
      right: 20px;
      border: none;
      border-radius: 10px;
      padding: 10px;
      background-color: lightgray;
    }
    /* Add this CSS */
    #myBtn:before {
      content:"☀";
    }
    /* Add this CSS */
    .dark-mode #myBtn:before {
      content:"🌙";
    }
  </style>


<button id="myBtn" onclick="myFunction()">
</button>
<script>
    function myFunction() {
       var element = document.body;
       element.classList.toggle("dark-mode");
       if (element.classList.contains("dark-mode")) {
         document.querySelector('meta[name="theme-color"]').setAttribute("content", "#1c1c1c");
         document.querySelector('meta[name="theme"]').setAttribute("content", "cyborg");
       } else {
         document.querySelector('meta[name="theme-color"]').setAttribute("content", "");
         document.querySelector('meta[name="theme"]').setAttribute("content", "spacelab");
       }
    }
  </script>

<a href="#" id="back-to-top" title="Back to top">^</a>
<style>
    #back-to-top {
        position: fixed;
        bottom: 20px;
        right: 20px;
        font-size: 24px;
        color: #fff;
        background-color: #000;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        text-align: center;
        line-height: 40px;
    }
</style>
<p>👉🏻<a href="../ENV222%20exercise/ENV222%20exercise.html">Click to enter the ENV222 exercise section</a><br> 👉🏻<a href="../ENV221%20note/ENV221%20note.html">Click to enter the ENV221 note section</a></p>
<section id="r-markdown-syntax" class="level1">
<h1><span style="color:gray; font-family:Microsoft JhengHei;"><strong>1</strong></span> R-markdown syntax</h1>
<section id="fundamental" class="level2">
<h2 class="anchored" data-anchor-id="fundamental"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>1.1</strong></span> Fundamental</h2>
<ul>
<li><p>Subscript by Rmarkdown: Use <code>PM~2.5~</code> to form PM<sub>2.5</sub>. <br>Subscript by html: <code>log&lt;sub&gt;2&lt;/sub&gt;</code> will be displayed as log<sub>2</sub>.<br></p></li>
<li><p>Superscript by Rmarkdown: Use <code>R^2^</code> to form R<sup>2</sup>. <br>Superscript by html: <code>2&lt;sup&gt;n&lt;/sup&gt;</code> will be displayed as 2<sup>n</sup>.<br></p></li>
<li><p>Use <code>$E = mc^2$</code> to form <span class="math inline">\(E = mc^2\)</span><br></p></li>
<li><p>Use <code>[Link of XJTLU](http://xjtlu.edu.cn)</code> to form <a href="https://www.xjtlu.edu.cn/en/">Link of XJTLU</a><br></p></li>
<li><p>Use <code>&lt;center&gt;&lt;img src="images/rstudio-qmd-how-it-works.png" width="1400" height="257"/&gt;</code> or <code>&lt;center&gt; ![rstudio qmd how it works](images/rstudio-qmd-how-it-works.png){width=100%}</code> to form<br></p>
<center>
<p><img src="images/rstudio-qmd-how-it-works.png" class="img-fluid" style="width:100.0%" alt="rstudio qmd how it works"><br></p></center></li>
<li><p>Use something like <code>{r, fig.width = 6, fig.height = 4, fig.align='center'}</code> in front of the code chunk to change the output graphics</p></li>
<li><p>Also, use<code>{r, XXX-Plot, fig.cap="XXX-Plot"}</code> in the front of code chunk to add a caption of this figure</p></li>
<li><p>Use something like<code>&lt;span style="color:red; font-weight:bold; font-size:16px; font-family:Tahoma;"&gt;sentence&lt;/span&gt;</code> to change the properties of text</p></li>
<li><p>Use<br> <code>| Name | Math | English |</code><br> <code>|:----:|:-----|--------:|</code><br> <code>| Tom  | 93   |     100 |</code><br> <code>| Mary | 60   |      90 |</code><br> to form<br></p></li>
</ul>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;">Name</th>
<th style="text-align: left;">Math</th>
<th style="text-align: right;">English</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Tom</td>
<td style="text-align: left;">93</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="even">
<td style="text-align: center;">Mary</td>
<td style="text-align: left;">60</td>
<td style="text-align: right;">90</td>
</tr>
</tbody>
</table>
<ul>
<li>Or use</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Math =</span> <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">90</span>),</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">English =</span> <span class="fu">c</span>(<span class="dv">85</span>, <span class="dv">95</span>),</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">"Tom"</span>, <span class="st">"Mary"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(df, <span class="at">format =</span> <span class="st">"markdown"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Math</th>
<th style="text-align: right;">English</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Tom</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">85</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mary</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">95</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>Use</li>
</ul>
<pre><code>- 1. 
- 2. 
    - 1.
    - 2.
- 3.</code></pre>
<p>to form sub-rank like this below:<br></p>
<ul>
<li><ol type="1">
<li></li>
</ol></li>
<li><ol start="2" type="1">
<li></li>
</ol>
<ul>
<li><ol type="1">
<li></li>
</ol></li>
<li><ol start="2" type="1">
<li></li>
</ol></li>
</ul></li>
<li><ol start="3" type="1">
<li></li>
</ol></li>
</ul>
</section>
<section id="advanced" class="level2">
<h2 class="anchored" data-anchor-id="advanced"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>1.2</strong></span> Advanced</h2>
<ul>
<li>Numbering, caption, and cross-reference of R-plots in academic paper <a href="https://pzhao.org/openr/R-graphs-advanced.html">Click to see the detail in ENV222 Week5-5.2</a></li>
</ul>
</section>
</section>
<section id="basic-r-charaters" class="level1">
<h1><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2</strong></span> Basic R charaters</h1>
<section id="check-the-data-type" class="level2">
<h2 class="anchored" data-anchor-id="check-the-data-type"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2.1</strong></span> Check the data type</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import dataset</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="st">'The world is on the verge of being flipped topsy-turvy.'</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>dtf <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'data/student_names.csv'</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dtf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Name Prgrm
1   Yuzhou Liu   Bio
2 Penghui Wang   Bio
3     Ziang Li   Eco
4 Youcheng Jin   Bio
5    Yuge Yang   Bio
6  Yutian Song   Eco</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data type</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># length of the dataset</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># length of the sub dataset</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nchar</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 55</code></pre>
</div>
</div>
</section>
<section id="index-to-maximum-and-minimum-values" class="level2">
<h2 class="anchored" data-anchor-id="index-to-maximum-and-minimum-values"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2.2</strong></span> Index to maximum and minimum values</h2>
<ul>
<li>Find the longest name in <span style="color:green"><em>student_names.csv</em></span>, <code>which.max</code> or <code>which.min</code> is used to find the index of the (first) minimum or maximum of a numeric (or logical) vector</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>name_n <span class="ot">&lt;-</span> <span class="fu">nchar</span>(dtf<span class="sc">$</span>Name)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>name_nmax <span class="ot">&lt;-</span> <span class="fu">which.max</span>(name_n)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>dtf<span class="sc">$</span>Name[name_nmax]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Iyan Hafiz Bin Mohamed Faizel"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>dtf<span class="sc">$</span>Name[<span class="fu">which.max</span>(<span class="fu">nchar</span>((dtf<span class="sc">$</span>Name)))]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Iyan Hafiz Bin Mohamed Faizel"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>dtf<span class="sc">$</span>Name <span class="sc">%&gt;%</span> <span class="fu">nchar</span>() <span class="sc">%&gt;%</span> <span class="fu">which.max</span>() <span class="sc">%&gt;%</span> dtf<span class="sc">$</span>Name[.]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Iyan Hafiz Bin Mohamed Faizel"</code></pre>
</div>
</div>
</section>
<section id="capital-and-small-letter" class="level2">
<h2 class="anchored" data-anchor-id="capital-and-small-letter"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2.3</strong></span> Capital and small letter</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tolower() toupper()</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>(xupper <span class="ot">&lt;-</span> <span class="fu">toupper</span>(x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "THE WORLD IS ON THE VERGE OF BEING FLIPPED TOPSY-TURVY."</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>(dtf<span class="sc">$</span>pro <span class="ot">&lt;-</span> <span class="fu">tolower</span>(dtf<span class="sc">$</span>Prgrm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "bio" "bio" "eco" "bio" "bio" "eco" "bio" "bio" "eco" "bio" "eco" "bio"
[13] "bio" "env" "bio" "bio" "bio" "env" "bio" "env" "bio" "bio" "bio" "bio"
[25] "eco" "eco" "env" "bio" "bio" "bio" "bio" "env" "bio" "bio" "bio" "bio"
[37] "bio" "eco" "eco" "bio" "bio" "bio" "bio" "bio" "bio" "bio" "bio" "eco"
[49] "bio" "bio" "env" "eco" "eco" "bio" "env" "env" "env"</code></pre>
</div>
</div>
</section>
<section id="split-string" class="level2">
<h2 class="anchored" data-anchor-id="split-string"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2.4</strong></span> Split string</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># strsplit()</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>x_word <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(xupper, <span class="st">' '</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(x_word)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "list"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># If you want to extract the first element in the list, you need to use double brackets [[]], and if you want to extract the first sublist in the list, use single brackets []</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>x_word1 <span class="ot">&lt;-</span> x_word[[<span class="dv">1</span>]]</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(x_word1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(x_word1)  <span class="co"># Form a table which involved the frequency of each char acter</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>x_word1
       BEING      FLIPPED           IS           OF           ON          THE 
           1            1            1            1            1            2 
TOPSY-TURVY.        VERGE        WORLD 
           1            1            1 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>x_word1[<span class="sc">!</span><span class="fu">duplicated</span>(x_word1)]  <span class="co"># Find the distinct characters in the list by use duplicated() function</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "THE"          "WORLD"        "IS"           "ON"           "VERGE"       
[6] "OF"           "BEING"        "FLIPPED"      "TOPSY-TURVY."</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(x_word1)  <span class="co"># Other way yo detect the distinct characters</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "THE"          "WORLD"        "IS"           "ON"           "VERGE"       
[6] "OF"           "BEING"        "FLIPPED"      "TOPSY-TURVY."</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(x_word, length)  <span class="co"># The output of the lapply() function is a list</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(x_word, length)  <span class="co"># The output of the sapply() function is a vector or a matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(x_word, nchar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1]
 [1,]    3
 [2,]    5
 [3,]    2
 [4,]    2
 [5,]    3
 [6,]    5
 [7,]    2
 [8,]    5
 [9,]    7
[10,]   12</code></pre>
</div>
</div>
</section>
<section id="separate-column" class="level2">
<h2 class="anchored" data-anchor-id="separate-column"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2.5</strong></span> Separate column</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># separate() is a function in the tidyr package that can be used to split a column in a data box into multiple columns</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'tidyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:magrittr':

    extract</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>dtf2 <span class="ot">&lt;-</span> <span class="fu">separate</span>(dtf, Name, <span class="fu">c</span>(<span class="st">"GivenName"</span>, <span class="st">"LastName"</span>), <span class="at">sep =</span> <span class="st">' '</span>)  <span class="co"># separate(data, col, into, sep)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Expected 2 pieces. Additional pieces discarded in 3 rows [8, 9, 57].</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>dtf<span class="sc">$</span>FamilyName <span class="ot">&lt;-</span> dtf2<span class="sc">$</span>LastName</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dtf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Name Prgrm pro FamilyName
1   Yuzhou Liu   Bio bio        Liu
2 Penghui Wang   Bio bio       Wang
3     Ziang Li   Eco eco         Li
4 Youcheng Jin   Bio bio        Jin
5    Yuge Yang   Bio bio       Yang
6  Yutian Song   Eco eco       Song</code></pre>
</div>
</div>
</section>
<section id="extract" class="level2">
<h2 class="anchored" data-anchor-id="extract"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2.6</strong></span> Extract</h2>
<p>The world is <span style="color:red">on</span> the verge of being flipped topsy-turvy.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># substr() is a built-in function in R that can be used to extract or replace substrings from a character vector</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">substr</span>(x, <span class="dv">13</span>, <span class="dv">15</span>)  <span class="co"># substr(x, start, stop)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] " on"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>dtf<span class="sc">$</span>NameAbb <span class="ot">&lt;-</span> <span class="fu">substr</span>(dtf<span class="sc">$</span>Name, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dtf, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Name Prgrm pro FamilyName NameAbb
1   Yuzhou Liu   Bio bio        Liu       Y
2 Penghui Wang   Bio bio       Wang       P
3     Ziang Li   Eco eco         Li       Z</code></pre>
</div>
</div>
</section>
<section id="connect" class="level2">
<h2 class="anchored" data-anchor-id="connect"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2.7</strong></span> Connect</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># paste() function can convert multiple objects into character vectors and concatenate them</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(x, <span class="st">'&lt;end&gt;'</span>, <span class="at">sep =</span> <span class="st">' '</span>)  <span class="co"># paste(x1, x2,... sep, collapse)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "The world is on the verge of being flipped topsy-turvy. &lt;end&gt;"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(dtf<span class="sc">$</span>NameAbb, <span class="st">'.'</span>, <span class="at">sep =</span> <span class="st">''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Y." "P." "Z." "Y." "Y." "Y." "H." "A." "E." "J." "Y." "M." "Y." "Y." "X."
[16] "Z." "W." "J." "Q." "Y." "F." "Y." "Z." "M." "Z." "S." "X." "J." "R." "Z."
[31] "Y." "X." "Z." "Y." "Q." "Y." "Y." "M." "Q." "J." "Y." "X." "M." "Q." "Y."
[46] "P." "Y." "J." "L." "Y." "Q." "H." "Z." "H." "J." "Y." "I."</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(dtf<span class="sc">$</span>NameAbb, <span class="at">collapse =</span> <span class="st">' '</span>)  <span class="co"># collapse = ' ' put all of the characters into a character</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Y P Z Y Y Y H A E J Y M Y Y X Z W J Q Y F Y Z M Z S X J R Z Y X Z Y Q Y Y M Q J Y X M Q Y P Y J L Y Q H Z H J Y I"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(dtf<span class="sc">$</span>NameAbb, dtf<span class="sc">$</span>FamilyName, <span class="at">sep =</span> <span class="st">'. '</span>)[<span class="dv">7</span>]  <span class="co"># This is my name for academic essay cite</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "H. Zhu"</code></pre>
</div>
</div>
</section>
<section id="find" class="level2">
<h2 class="anchored" data-anchor-id="find"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2.8</strong></span> Find</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># grep() function in R is a built-in function that searches for a pattern match in each element of character </span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"R"</span>, <span class="st">"Python"</span>, <span class="st">"Java"</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span>(<span class="st">"Java"</span>, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(y)) {</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">grep</span>(<span class="fu">as.character</span>(y[i]), y))</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1
[1] 2
[1] 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(y, <span class="cf">function</span>(x) <span class="fu">grep</span>(x, y))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     R Python   Java 
     1      2      3 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">table</span>(dtf2<span class="sc">$</span>GivenName), <span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
      Adriel        Elina       Fengyi        Haode       Hongli Huangtianchi 
           1            1            1            1            1            1 
        Iyan       Jiajie       Jiawei        Jiayi      Jingyun       Jiumei 
           1            1            1            2            1            1 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span>(<span class="st">'Jiayi'</span>, dtf<span class="sc">$</span>Name, <span class="at">value =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Jiayi Chen" "Jiayi Guo" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span>(<span class="st">'Jiayi|Guo'</span>, dtf<span class="sc">$</span>Name, <span class="at">value =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Jiayi Chen" "Fengyi Guo" "Jiayi Guo" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># regexpr() function is used to identify the position of the pattern in the character vector, where each element is searched separately.</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"R is fun"</span>, <span class="st">"R is cool"</span>, <span class="st">"R is awesome"</span>)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="fu">regexpr</span>(<span class="st">"is"</span>, z)  <span class="co"># Returns include starting position, duration length, data type ...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3 3 3
attr(,"match.length")
[1] 2 2 2
attr(,"index.type")
[1] "chars"
attr(,"useBytes")
[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gregexpr</span>(<span class="st">"is"</span>, z)  <span class="co"># The gregexpr() function returns all matching positions and lengths, as a list</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] 3
attr(,"match.length")
[1] 2
attr(,"index.type")
[1] "chars"
attr(,"useBytes")
[1] TRUE

[[2]]
[1] 3
attr(,"match.length")
[1] 2
attr(,"index.type")
[1] "chars"
attr(,"useBytes")
[1] TRUE

[[3]]
[1] 3
attr(,"match.length")
[1] 2
attr(,"index.type")
[1] "chars"
attr(,"useBytes")
[1] TRUE</code></pre>
</div>
</div>
</section>
<section id="replace" class="level2">
<h2 class="anchored" data-anchor-id="replace"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2.9</strong></span> Replace</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gsub()</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gsub</span>(<span class="st">' '</span>, <span class="st">'-'</span>, x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "The-world-is-on-the-verge-of-being-flipped-topsy-turvy."</code></pre>
</div>
</div>
</section>
<section id="regular-expression" class="level2">
<h2 class="anchored" data-anchor-id="regular-expression"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2.10</strong></span> <span style="color:orange">Regular expression</span></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># help(regex)</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the one who has a given name with 4 letters and a family name with 4 letters</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span>(<span class="st">'^[[:alpha:]]{4} [[:alpha:]]{4}$'</span>, dtf<span class="sc">$</span>Name, <span class="at">value =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Yuge Yang" "Ziyu Yuan" "Qian Chen" "Ying Zhou"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Here, parentheses are used to create a capturing group. A capturing group is a subexpression of a regular expression that can capture and store the matched text during matching. </span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="co"># In this example, the capturing group is used to extract the first word from the string. Without a capturing group, the entire matched string would be replaced with \\1 instead of just the first word.</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>dtf<span class="sc">$</span>FirstName <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">'^([^ ]+).+[^ ]+$'</span>, <span class="st">'</span><span class="sc">\\</span><span class="st">1'</span>, dtf<span class="sc">$</span>Name)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dtf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Name Prgrm pro FamilyName NameAbb FirstName
1   Yuzhou Liu   Bio bio        Liu       Y    Yuzhou
2 Penghui Wang   Bio bio       Wang       P   Penghui
3     Ziang Li   Eco eco         Li       Z     Ziang
4 Youcheng Jin   Bio bio        Jin       Y  Youcheng
5    Yuge Yang   Bio bio       Yang       Y      Yuge
6  Yutian Song   Eco eco       Song       Y    Yutian</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>Rmarkdown 中正则表达式的基本语法如下：</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  . 匹配任意单个字符，除了换行符。</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  [ ] 匹配方括号内的任意一个字符，例如 [abc] 匹配 a 或 b 或 c。</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  [<span class="sc">^</span> ] 匹配方括号外的任意一个字符，例如 [<span class="sc">^</span>abc] 匹配除了 a 和 b 和 c 之外的任意字符。</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span> 在方括号内表示范围，例如 [a<span class="sc">-</span>z] 匹配小写字母， [<span class="dv">0-9</span>] 匹配数字。</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  \d \D \w \W \s \S 分别匹配数字、非数字、单词字符（字母、数字和下划线）、非单词字符、空白符（空格、制表符和换行符）、非空白符。</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>  \b \B <span class="sc">^</span> <span class="er">$</span> \ 分别匹配单词边界（单词和非单词之间）、非单词边界（两个单词或两个非单词之间）、字符串开头、字符串结尾、转义符（用于匹配元字符本身）。</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>  ( ) <span class="sc">|</span> ? <span class="sc">+</span> <span class="er">*</span> { } \ 分别匹配分组或捕获子表达式（可以用反斜杠加数字引用），选择（匹配左边或右边），零次或一次重复，一次或多次重复，零次或多次重复，指定重复次数，零宽断言（匹配位置而不是字符）。</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>简单的例子，查找 Markdown 链接（[This is a link](https<span class="sc">:</span><span class="er">//</span>www.example.com)）：</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>\[([<span class="sc">^</span>\]]<span class="sc">+</span>)\]\(([<span class="sc">^</span>)]<span class="sc">+</span>)\<span class="er">)</span></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>这个正则表达式可以分解为以下部分：</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>  \[ 匹配左方括号</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>  ([<span class="sc">^</span>\]]<span class="sc">+</span>) 匹配并捕获一个或多个不是右方括号的字符</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>  \] 匹配右方括号</span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>  \( 匹配左圆括号</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>  ([<span class="sc">^</span>)]<span class="sc">+</span>) 匹配并捕获一个或多个不是右圆括号的字符</span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>  \<span class="er">)</span> 匹配右圆括号</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="time-data-in-r" class="level1">
<h1><span style="color:gray; font-family:Microsoft JhengHei;"><strong>3</strong></span> Time data in R</h1>
<section id="format-of-time" class="level2">
<h2 class="anchored" data-anchor-id="format-of-time"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>3.1</strong></span> Format of time</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the current date</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">date</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Tue Apr  4 13:22:38 2023"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># character</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="st">"2/11/1962"</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Date/Time format, we can just directly use like "d2 + 1" to add 1 day to d2</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">Sys.Date</span>()</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Check their type</span></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(<span class="fu">list</span>(<span class="fu">class</span>(d1), <span class="fu">class</span>(d2), <span class="fu">class</span>(t2)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]        [,2]   [,3]       
[1,] "character" "Date" character,2</code></pre>
</div>
</div>
</section>
<section id="numeric-of-date" class="level2">
<h2 class="anchored" data-anchor-id="numeric-of-date"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>3.2</strong></span> Numeric of date</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use format="" to identify the character to date</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>d3 <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2/11/1962"</span>, <span class="at">format=</span><span class="st">"%d/%m/%Y"</span> )</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(d3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -2617</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>d3 <span class="sc">+</span> <span class="dv">2617</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1970-01-01"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span>(d3, <span class="st">'%Y %m %d'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1962 11 02"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span>(d3, <span class="st">"%Y %B %d %A"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1962 十一月 02 星期五"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Different format will have different meaning</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>d4 <span class="ot">&lt;-</span> <span class="fu">as.Date</span>( <span class="st">"2/11/1962"</span>, <span class="at">format=</span><span class="st">"%m/%d/%Y"</span> )</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>d3 <span class="sc">==</span> d4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<section id="time-format-codes" class="level3">
<h3 class="anchored" data-anchor-id="time-format-codes"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>3.2.1</strong></span> Time format codes</h3>
<p><code>%Y</code>: Four-digit year<br> <code>%y</code>: Two-digit year<br> <code>%m</code>: Two-digit month (01~12)<br> <code>%d</code>: Two-digit day of the month (01~31)<br> <code>%H</code>: Hour in 24-hour format (00~23)<br> <code>%M</code>: Two-digit minute (00~59)<br> <code>%S</code>: Two-digit second (00~59)<br> <code>%z</code>: Time zone offset, for example +0800<br> <code>%Z</code>: Time zone name, for example CST</p>
</section>
</section>
<section id="calculating-date" class="level2">
<h2 class="anchored" data-anchor-id="calculating-date"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>3.3</strong></span> Calculating date</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import built-in data diet (The data concern a subsample of subjects drawn from larger cohort studies of the incidence of coronary heart disease (CHD))</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">'Epi'</span>)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"diet"</span>)</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(diet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   337 obs. of  15 variables:
 $ id        : num  102 59 126 16 247 272 268 206 182 2 ...
 $ doe       : Date, format: "1976-01-17" "1973-07-16" ...
 $ dox       : Date, format: "1986-12-02" "1982-07-05" ...
 $ dob       : Date, format: "1939-03-02" "1912-07-05" ...
 $ y         : num  10.875 8.969 14.01 0.627 11.274 ...
 $ fail      : num  0 0 13 3 13 3 0 0 13 0 ...
 $ job       : Factor w/ 3 levels "Driver","Conductor",..: 1 1 2 1 3 3 3 3 2 1 ...
 $ month     : num  1 7 3 5 3 3 2 1 3 12 ...
 $ energy    : num  22.9 23.9 25 22.2 18.5 ...
 $ height    : num  182 166 152 171 178 ...
 $ weight    : num  88.2 58.7 49.9 89.4 97.1 ...
 $ fat       : num  9.17 9.65 11.25 7.58 9.15 ...
 $ fibre     : num  1.4 0.935 1.248 1.557 0.991 ...
 $ energy.grp: Factor w/ 2 levels "&lt;=2750 KCals",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ chd       : num  0 0 1 1 1 1 0 0 1 0 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data which we will deal with</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>bdat <span class="ot">&lt;-</span> diet<span class="sc">$</span>dox[<span class="dv">1</span>]</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>bdat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1986-12-02"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Some basic calculation between dates</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>bdat <span class="sc">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1986-12-03"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>diet<span class="sc">$</span>dox2 <span class="ot">&lt;-</span> <span class="fu">format</span>(diet<span class="sc">$</span>dox, <span class="at">format=</span><span class="st">"%A %d %B %Y"</span>)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(diet<span class="sc">$</span>dox2, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "星期二 02 十二月 1986" "星期一 05 七月 1982"   "星期二 20 三月 1984"  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Some advanced calculation between dates</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(diet<span class="sc">$</span>dox)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1986-12-02"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(diet<span class="sc">$</span>dox)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1968-08-29" "1986-12-02"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(diet<span class="sc">$</span>dox)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1984-02-20"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(diet<span class="sc">$</span>dox)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1986-12-02"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">diff</span>(<span class="fu">range</span>(diet<span class="sc">$</span>dox))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 6669 days</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">difftime</span>(<span class="fu">min</span>(diet<span class="sc">$</span>dox), <span class="fu">max</span>(diet<span class="sc">$</span>dox), <span class="at">units =</span> <span class="st">"weeks"</span>)  <span class="co"># Set unit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of -952.7143 weeks</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Epi::cal.yr() function converts the date format to numeric format</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>diet2 <span class="ot">&lt;-</span> Epi<span class="sc">::</span><span class="fu">cal.yr</span>(diet)</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(diet2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   337 obs. of  16 variables:
 $ id        : num  102 59 126 16 247 272 268 206 182 2 ...
 $ doe       : 'cal.yr' num  1976 1974 1970 1969 1968 ...
 $ dox       : 'cal.yr' num  1987 1983 1984 1970 1979 ...
 $ dob       : 'cal.yr' num  1939 1913 1920 1907 1919 ...
 $ y         : num  10.875 8.969 14.01 0.627 11.274 ...
 $ fail      : num  0 0 13 3 13 3 0 0 13 0 ...
 $ job       : Factor w/ 3 levels "Driver","Conductor",..: 1 1 2 1 3 3 3 3 2 1 ...
 $ month     : num  1 7 3 5 3 3 2 1 3 12 ...
 $ energy    : num  22.9 23.9 25 22.2 18.5 ...
 $ height    : num  182 166 152 171 178 ...
 $ weight    : num  88.2 58.7 49.9 89.4 97.1 ...
 $ fat       : num  9.17 9.65 11.25 7.58 9.15 ...
 $ fibre     : num  1.4 0.935 1.248 1.557 0.991 ...
 $ energy.grp: Factor w/ 2 levels "&lt;=2750 KCals",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ chd       : num  0 0 1 1 1 1 0 0 1 0 ...
 $ dox2      : chr  "星期二 02 十二月 1986" "星期一 05 七月 1982" "星期二 20 三月 1984" "星期三 31 十二月 1969" ...</code></pre>
</div>
</div>
</section>
<section id="set-time-zone-calculation" class="level2">
<h2 class="anchored" data-anchor-id="set-time-zone-calculation"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>3.4</strong></span> Set time zone &amp; calculation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>bd <span class="ot">&lt;-</span> <span class="st">'1994-09-22 20:30:00'</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(bd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>bdtime <span class="ot">&lt;-</span> <span class="fu">strptime</span>(<span class="at">x =</span> bd, <span class="at">format =</span> <span class="st">'%Y-%m-%d %H:%M:%S'</span>, <span class="at">tz =</span> <span class="st">"Asia/Shanghai"</span>)  <span class="co"># Set character to time format and add a time zone</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(bdtime)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "POSIXlt" "POSIXt" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(<span class="fu">unclass</span>(bdtime))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     sec min hour mday mon year wday yday isdst zone  gmtoff
[1,] 0   30  20   22   8   94   4    264  0     "CST" NA    
attr(,"tzone")
[1] "Asia/Shanghai" "CST"           "CDT"          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>bdtime<span class="sc">$</span>wday</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span>(bdtime, <span class="at">format =</span> <span class="st">'%d.%m.%Y'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "22.09.1994"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>bdtime <span class="sc">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1994-09-22 20:30:01 CST"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Also, some essential calculation</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>bd2 <span class="ot">&lt;-</span> <span class="st">'1995-09-01 7:30:00'</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>bdtime2 <span class="ot">&lt;-</span> <span class="fu">strptime</span>(bd2, <span class="at">format =</span> <span class="st">'%Y-%m-%d %H:%M:%S'</span>, <span class="at">tz =</span> <span class="st">'Asia/Shanghai'</span>)</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>bdtime2 <span class="sc">-</span> bdtime</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 343.4583 days</code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">difftime</span>(<span class="at">time1 =</span> bdtime2, <span class="at">time2 =</span> bdtime, <span class="at">units =</span> <span class="st">'secs'</span>)  <span class="co"># Set unit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 29674800 secs</code></pre>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">c</span>(bdtime, bdtime2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1995-03-13 14:00:00 CST"</code></pre>
</div>
</div>
</section>
</section>
<section id="latex" class="level1">
<h1><span style="color:gray; font-family:Microsoft JhengHei;"><strong>4</strong></span> <span style="color:orange">LaTeX</span></h1>
<section id="fundamental-1" class="level2">
<h2 class="anchored" data-anchor-id="fundamental-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>4.1</strong></span> Fundamental</h2>
<center>
<img src="images/Mathematical Annotation in R.png" width="600" height="579">
</center>
<ul>
<li>Use <code>$$e^{i\pi}+1=0$$</code> to form Euler’s Law expression <span class="math display">\[e^{i\pi}+1=0\]</span></li>
<li><a href="https://blog.csdn.net/ViatorSun/article/details/82826664">Hyperlink of a CN website for more detail about LaTeX</a></li>
</ul>
</section>
<section id="advanced-1" class="level2">
<h2 class="anchored" data-anchor-id="advanced-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>4.2</strong></span> Advanced</h2>
<ul>
<li>Here are some additional formulas from ENV221 statistic method:<br>
<ol type="1">
<li><span style="color:orange">Z-test</span>:<br> The LaTex expression for Z-test is: <span class="math display">\[Z=\frac{\overline{x}-\mu}{\frac{\sigma}{\sqrt{n}}}\]</span> where <span class="math inline">\(\overline{x}\)</span> is the sample mean, <span class="math inline">\(\mu\)</span> is the population mean, <span class="math inline">\(\sigma\)</span> is the population standard deviation, and <span class="math inline">\(n\)</span> is the sample size.</li>
<li><span style="color:orange">t-test</span>:<br> The LaTex expression for t-test is: <span class="math display">\[t=\frac{\overline{x}-\mu}{\frac{s}{\sqrt{n}}}\]</span> where <span class="math inline">\(\overline{x}\)</span> is the sample mean, <span class="math inline">\(\mu\)</span> is the population mean, <span class="math inline">\(s\)</span> is the sample standard deviation, and <span class="math inline">\(n\)</span> is the sample size.</li>
<li><span style="color:orange">F-test</span>:<br> The LaTex expression for F-test is: <span class="math display">\[F=\frac{s_1^2}{s_2^2}\]</span> where <span class="math inline">\(s_1^2\)</span> is the variance of the first sample and <span class="math inline">\(s_2^2\)</span> is the variance of the second sample.</li>
<li><span style="color:orange">Chi-square test</span>:<br> The LaTex expression for the chi-square test is: <span class="math display">\[\chi2=\sum_{i=1}{n}\frac{(O_i-E_i)^2}{E_i}\]</span> where <span class="math inline">\(O_i\)</span> represents observed values and <span class="math inline">\(E_i\)</span> represents expected values.</li>
</ol></li>
</ul>
</section>
</section>
<section id="r-graph-advanced" class="level1">
<h1><span style="color:gray; font-family:Microsoft JhengHei;"><strong>5</strong></span> R graph (advanced)</h1>
<section id="r-graph-advanceddifferent-theme-of-plot" class="level2">
<h2 class="anchored" data-anchor-id="r-graph-advanceddifferent-theme-of-plot"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>5.1</strong></span> R graph (advanced)Different theme of plot</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>bw <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(CO2) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(conc, uptake)) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(CO2) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(conc, uptake)) <span class="sc">+</span> <span class="fu">theme_test</span>()</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>classic <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(CO2) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(conc, uptake)) <span class="sc">+</span> <span class="fu">theme_classic</span>()</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>bw <span class="sc">+</span> test <span class="sc">+</span> classic <span class="sc">+</span> </span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">expression</span>(CO[<span class="dv">2</span>] <span class="sc">*</span> <span class="st">" uptake by plant type plot with different theme"</span>),</span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">tag_levels =</span> <span class="st">"A"</span></span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="r-graph-advancedmath-formulas-with-r" class="level2">
<h2 class="anchored" data-anchor-id="r-graph-advancedmath-formulas-with-r"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>5.2</strong></span> R graph (advanced)Math formulas with R</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(CO2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Grouped Data: uptake ~ conc | Plant
  Plant   Type  Treatment conc uptake
1   Qn1 Quebec nonchilled   95   16.0
2   Qn1 Quebec nonchilled  175   30.4
3   Qn1 Quebec nonchilled  250   34.8
4   Qn1 Quebec nonchilled  350   37.2
5   Qn1 Quebec nonchilled  500   35.3
6   Qn1 Quebec nonchilled  675   39.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fundamental expression</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(CO2<span class="sc">$</span>conc, CO2<span class="sc">$</span>uptake, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">las =</span> <span class="dv">1</span>, </span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">'CO2 concentration'</span>, <span class="at">ylab =</span> <span class="st">'CO2 uptake'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Advanced expression (Use `?plotmath` to check more details of mathematical annotation in R)</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(CO2<span class="sc">$</span>conc, CO2<span class="sc">$</span>uptake, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">las =</span> <span class="dv">1</span>, </span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="st">'CO'</span>[<span class="dv">2</span>] <span class="sc">*</span> <span class="st">' concentration (mL/L)'</span>), </span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">'CO'</span>[<span class="dv">2</span>] <span class="sc">*</span> <span class="st">' uptake ('</span> <span class="sc">*</span>mu <span class="sc">*</span> <span class="st">'mol m'</span><span class="sc">^-</span><span class="dv">2</span> <span class="sc">*</span> <span class="st">'s'</span><span class="sc">^-</span><span class="dv">1</span> <span class="sc">*</span> <span class="st">')'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-18-2.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># LaTeX expression</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(latex2exp)</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(CO2<span class="sc">$</span>conc, CO2<span class="sc">$</span>uptake, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">las =</span> <span class="dv">1</span>, </span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">TeX</span>(<span class="st">'CO$_2$ concentration (mL/L)'</span>), </span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="fu">TeX</span>(<span class="st">'CO$_2$ uptake ($</span><span class="sc">\\</span><span class="st">mu$mol m$^{-2}$ s$^{-1}$)'</span>))</span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">850</span>, <span class="dv">30</span>, <span class="fu">expression</span>(<span class="fu">prod</span>(<span class="fu">plain</span>(P)(X <span class="sc">==</span> x), x)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-18-3.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><a href="https://www.cnblogs.com/kisen/p/12574830.html">Hyperlink of a CN website for more detail about Mathematical Annotation in R</a></li>
</ul>
</section>
<section id="r-graph-advancedsize-and-layout" class="level2">
<h2 class="anchored" data-anchor-id="r-graph-advancedsize-and-layout"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>5.3</strong></span> R graph (advanced)Size and layout</h2>
<ul>
<li>ggplot2: patchwork package is used to range the size and layout of multiply plots</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(airquality) <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="fu">as.factor</span>(Month), Ozone))</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(airquality) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(Solar.R, Ozone))</span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(airquality) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(Ozone))</span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 37 rows containing non-finite values (`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 42 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 37 rows containing non-finite values (`stat_bin()`).</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">/</span> p3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 37 rows containing non-finite values (`stat_boxplot()`).
Removed 42 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 37 rows containing non-finite values (`stat_bin()`).</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-19-2.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">+</span> p2) <span class="sc">/</span> p3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 37 rows containing non-finite values (`stat_boxplot()`).
Removed 42 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 37 rows containing non-finite values (`stat_bin()`).</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-19-3.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">+</span> p2) <span class="sc">/</span> p3 <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>) <span class="sc">+</span> </span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))  <span class="co"># plot_layout() function is used to define the grid layout of the composite graph.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 37 rows containing non-finite values (`stat_boxplot()`).
Removed 42 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 37 rows containing non-finite values (`stat_bin()`).</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-19-4.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Built-in par() function</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>))  <span class="co"># Set the layout by using vector c(x, y)</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(airquality<span class="sc">$</span>Solar.R, airquality<span class="sc">$</span>Ozone)</span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(airquality<span class="sc">$</span>Solar.R)</span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(airquality<span class="sc">$</span>Month)</span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(airquality<span class="sc">$</span>Solar.R, airquality<span class="sc">$</span>Ozone)</span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(airquality<span class="sc">$</span>Solar.R)</span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(airquality<span class="sc">$</span>Month)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li><span style="color:red">Built-in layout() function</span></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use a matrix to store the information about layout</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>mymat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(mymat)</span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(airquality<span class="sc">$</span>Solar.R, airquality<span class="sc">$</span>Ozone)</span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(airquality<span class="sc">$</span>Solar.R)</span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(airquality<span class="sc">$</span>Month)</span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(airquality<span class="sc">$</span>Solar.R, airquality<span class="sc">$</span>Ozone)</span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(airquality<span class="sc">$</span>Solar.R)</span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(airquality<span class="sc">$</span>Month)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Also, customize the exact layout by using some parameters like 'widths=' and 'heights=' by filling vector</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>mymat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>mymat  <span class="co"># Check the matrix which was used to layout plots</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]    1    2    4
[2,]    1    3    5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(mymat, <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>), <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(airquality<span class="sc">$</span>Solar.R, airquality<span class="sc">$</span>Ozone)</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(airquality<span class="sc">$</span>Solar.R)</span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(airquality<span class="sc">$</span>Month)</span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(airquality<span class="sc">$</span>Solar.R, airquality<span class="sc">$</span>Ozone)</span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(airquality<span class="sc">$</span>Solar.R)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-21-2.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This is an example from quiz1. Also, please check the exercises to view more difficult questions</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>mymat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>mymat  <span class="co"># Check the matrix which was used to layout plots</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    1    3
[2,]    2    0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(mymat, <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>), <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))  <span class="co"># Set the ratio between widths and heights</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(iris<span class="sc">$</span>Sepal.Length, iris<span class="sc">$</span>Sepal.Width, <span class="at">pch=</span><span class="dv">20</span>, <span class="at">xlab=</span><span class="st">'Sepal Length (cm)'</span>, <span class="at">ylab=</span><span class="st">'Sepal Width (cm)'</span>, <span class="at">las=</span><span class="dv">1</span>)</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(iris<span class="sc">$</span>Sepal.Length, <span class="at">pch=</span><span class="dv">20</span>, <span class="at">las=</span><span class="dv">1</span>, <span class="at">horizontal=</span>T)</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(iris<span class="sc">$</span>Sepal.Width, <span class="at">pch=</span><span class="dv">20</span>, <span class="at">las=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-21-3.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="r-tidyverse" class="level1">
<h1><span style="color:gray; font-family:Microsoft JhengHei;"><strong>6</strong></span> R Tidyverse</h1>
<section id="workflow" class="level2">
<h2 class="anchored" data-anchor-id="workflow"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>6.1</strong></span> Workflow</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Tidyverse%20workflow.png" class="img-fluid figure-img" style="width:75.0%"></p>
<p></p><figcaption class="figure-caption">Tidyverse workflow</figcaption><p></p>
</figure>
</div>
</center>
</section>
<section id="fundamental-operations" class="level2">
<h2 class="anchored" data-anchor-id="fundamental-operations"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>6.2</strong></span> Fundamental operations</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the package</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.0     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ lubridate 1.9.2     ✔ tibble    3.1.8
✔ purrr     1.0.1     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ tidyr::extract()   masks magrittr::extract()
✖ dplyr::filter()    masks stats::filter()
✖ dplyr::lag()       masks stats::lag()
✖ purrr::set_names() masks magrittr::set_names()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the members of them</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidyverse_packages</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "broom"         "conflicted"    "cli"           "dbplyr"       
 [5] "dplyr"         "dtplyr"        "forcats"       "ggplot2"      
 [9] "googledrive"   "googlesheets4" "haven"         "hms"          
[13] "httr"          "jsonlite"      "lubridate"     "magrittr"     
[17] "modelr"        "pillar"        "purrr"         "ragg"         
[21] "readr"         "readxl"        "reprex"        "rlang"        
[25] "rstudioapi"    "rvest"         "stringr"       "tibble"       
[29] "tidyr"         "xml2"          "tidyverse"    </code></pre>
</div>
</div>
<p>Core members and their function:</p>
<ul>
<li><code>ggplot2</code>: Creating graphics</li>
<li><code>dplyr</code>: Data manipulation</li>
<li><code>tidyr</code>: Get to tidy data</li>
<li><code>readr</code>: Read rectangular data</li>
<li><code>purrr</code>: Functional programming</li>
<li><code>tibble</code>: Re-imagining of the data frame</li>
<li><code>stringr</code>: Working with strings</li>
<li><code>forcats</code>: Working with factors</li>
</ul>
</section>
<section id="pipe-operator" class="level2">
<h2 class="anchored" data-anchor-id="pipe-operator"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>6.3</strong></span> Pipe operator</h2>
<p>The pipe operator can be written as <code>%&gt;%</code> or <code>|&gt;</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.109</span>, <span class="fl">0.359</span>, <span class="fl">0.63</span>, <span class="fl">0.996</span>, <span class="fl">0.515</span>, <span class="fl">0.142</span>, <span class="fl">0.017</span>, <span class="fl">0.829</span>, <span class="fl">0.907</span>)</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Method 1:</span></span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">log</span>(x)</span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">diff</span>(y1)</span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(y2)</span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">round</span>(y3)</span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Method 2</span></span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">exp</span>(<span class="fu">diff</span>(<span class="fu">log</span>(x))))</span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Pipe method</span></span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> <span class="fu">log</span>() <span class="sc">%&gt;%</span> <span class="fu">diff</span>() <span class="sc">%&gt;%</span> <span class="fu">exp</span>() <span class="sc">%&gt;%</span> <span class="fu">round</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="mutiply-work-by-using-tidyverse-pipe" class="level2">
<h2 class="anchored" data-anchor-id="mutiply-work-by-using-tidyverse-pipe"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>6.4</strong></span> Mutiply work by using tidyverse pipe</h2>
<section id="graph-work" class="level3">
<h3 class="anchored" data-anchor-id="graph-work"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>6.4.1</strong></span> Graph work</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co"># By using R built-in par() function and a loop</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">boxplot</span>(iris[, i] <span class="sc">~</span> iris<span class="sc">$</span>Species, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xlab =</span> <span class="st">'Species'</span>, <span class="at">ylab =</span> <span class="fu">names</span>(iris)[i])</span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co"># By using pivot_longer() function and tidyverse pipe</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> <span class="fu">pivot_longer</span>(<span class="sc">-</span>Species) <span class="sc">|&gt;</span> <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(Species, value)) <span class="sc">+</span> <span class="fu">facet_wrap</span>(name <span class="sc">~</span>.)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-24-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="statistic-work" class="level3">
<h3 class="anchored" data-anchor-id="statistic-work"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>6.4.2</strong></span> Statistic work</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># base R</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>dtf1_mean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Species =</span> <span class="fu">unique</span>(iris<span class="sc">$</span>Species), <span class="at">Mean_Sepal_Length =</span> <span class="fu">tapply</span>(iris<span class="sc">$</span>Sepal.Length, iris<span class="sc">$</span>Species, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>dtf1_sd <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Species =</span> <span class="fu">unique</span>(iris<span class="sc">$</span>Species), <span class="at">SD_Sepal_Length =</span> <span class="fu">tapply</span>(iris<span class="sc">$</span>Sepal.Length, iris<span class="sc">$</span>Species, sd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>dtf1_median <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Species =</span> <span class="fu">unique</span>(iris<span class="sc">$</span>Species), <span class="at">Median_Sepal_Length =</span> <span class="fu">tapply</span>(iris<span class="sc">$</span>Sepal.Length, iris<span class="sc">$</span>Species, median, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(dtf1_mean) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Species"</span>, <span class="st">"Mean_Sepal_Length"</span>)</span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(dtf1_sd) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Species"</span>, <span class="st">"SD_Sepal_Length"</span>)</span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(dtf1_median) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Species"</span>, <span class="st">"Median_Sepal_Length"</span>)</span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(dtf1_mean, dtf1_sd, dtf1_median)  <span class="co"># Show them in one table</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Species Mean_Sepal_Length    Species SD_Sepal_Length    Species
setosa         setosa             5.006     setosa       0.3524897     setosa
versicolor versicolor             5.936 versicolor       0.5161711 versicolor
virginica   virginica             6.588  virginica       0.6358796  virginica
           Median_Sepal_Length
setosa                     5.0
versicolor                 5.9
virginica                  6.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use a loop</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>dtf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">3</span>))</span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a>  dtf1_mean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">tapply</span>(iris[, i], iris<span class="sc">$</span>Species, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a>  dtf1_sd <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">tapply</span>(iris[, i], iris<span class="sc">$</span>Species, sd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a>  dtf1_median <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">tapply</span>(iris[, i], iris<span class="sc">$</span>Species, median, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb173-7"><a href="#cb173-7" aria-hidden="true" tabindex="-1"></a>  dtf1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(dtf1_mean, dtf1_sd, dtf1_median)</span>
<span id="cb173-8"><a href="#cb173-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(dtf1) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">names</span>(iris)[i], <span class="st">'.'</span>, <span class="fu">c</span>(<span class="st">'mean'</span>, <span class="st">'sd'</span>, <span class="st">'median'</span>))</span>
<span id="cb173-9"><a href="#cb173-9" aria-hidden="true" tabindex="-1"></a>  dtf <span class="ot">&lt;-</span> <span class="fu">cbind</span>(dtf, dtf1)</span>
<span id="cb173-10"><a href="#cb173-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb173-11"><a href="#cb173-11" aria-hidden="true" tabindex="-1"></a>dtf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           rep.NA..3. Sepal.Length.mean Sepal.Length.sd Sepal.Length.median
setosa             NA             5.006       0.3524897                 5.0
versicolor         NA             5.936       0.5161711                 5.9
virginica          NA             6.588       0.6358796                 6.5
           Sepal.Width.mean Sepal.Width.sd Sepal.Width.median Petal.Length.mean
setosa                3.428      0.3790644                3.4             1.462
versicolor            2.770      0.3137983                2.8             4.260
virginica             2.974      0.3224966                3.0             5.552
           Petal.Length.sd Petal.Length.median Petal.Width.mean Petal.Width.sd
setosa           0.1736640                1.50            0.246      0.1053856
versicolor       0.4699110                4.35            1.326      0.1977527
virginica        0.5518947                5.55            2.026      0.2746501
           Petal.Width.median
setosa                    0.2
versicolor                1.3
virginica                 2.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tidyverse</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>dtf <span class="ot">&lt;-</span> iris <span class="sc">|&gt;</span> </span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>Species) <span class="sc">|&gt;</span> </span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Species, name) <span class="sc">|&gt;</span> </span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd   =</span> <span class="fu">sd</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">median =</span> <span class="fu">median</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb175-9"><a href="#cb175-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-10"><a href="#cb175-10" aria-hidden="true" tabindex="-1"></a>dtf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 5
   Species    name          mean    sd median
   &lt;fct&gt;      &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 setosa     Petal.Length 1.46  0.174   1.5 
 2 setosa     Petal.Width  0.246 0.105   0.2 
 3 setosa     Sepal.Length 5.01  0.352   5   
 4 setosa     Sepal.Width  3.43  0.379   3.4 
 5 versicolor Petal.Length 4.26  0.470   4.35
 6 versicolor Petal.Width  1.33  0.198   1.3 
 7 versicolor Sepal.Length 5.94  0.516   5.9 
 8 versicolor Sepal.Width  2.77  0.314   2.8 
 9 virginica  Petal.Length 5.55  0.552   5.55
10 virginica  Petal.Width  2.03  0.275   2   
11 virginica  Sepal.Length 6.59  0.636   6.5 
12 virginica  Sepal.Width  2.97  0.322   3   </code></pre>
</div>
</div>
</section>
</section>
<section id="tidy-the-dataset" class="level2">
<h2 class="anchored" data-anchor-id="tidy-the-dataset"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>6.5</strong></span> Tidy the dataset</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Original dataset of table1</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>table1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country      year  cases population
  &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;
1 Afghanistan  1999    745   19987071
2 Afghanistan  2000   2666   20595360
3 Brazil       1999  37737  172006362
4 Brazil       2000  80488  174504898
5 China        1999 212258 1272915272
6 China        2000 213766 1280428583</code></pre>
</div>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute rate per 10,000</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>table1 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">rate =</span> cases <span class="sc">/</span> population <span class="sc">*</span> <span class="dv">10000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  country      year  cases population  rate
  &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;
1 Afghanistan  1999    745   19987071 0.373
2 Afghanistan  2000   2666   20595360 1.29 
3 Brazil       1999  37737  172006362 2.19 
4 Brazil       2000  80488  174504898 4.61 
5 China        1999 212258 1272915272 1.67 
6 China        2000 213766 1280428583 1.67 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute cases per year</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>table1 <span class="sc">%&gt;%</span> <span class="fu">count</span>(year, <span class="at">wt =</span> cases)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
   year      n
  &lt;dbl&gt;  &lt;dbl&gt;
1  1999 250740
2  2000 296920</code></pre>
</div>
</div>
</section>
<section id="conversions-the-dataframe-type" class="level2">
<h2 class="anchored" data-anchor-id="conversions-the-dataframe-type"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>6.6</strong></span> Conversions the dataframe type</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Original dataset of table2</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>table2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 4
   country      year type            count
   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt;
 1 Afghanistan  1999 cases             745
 2 Afghanistan  1999 population   19987071
 3 Afghanistan  2000 cases            2666
 4 Afghanistan  2000 population   20595360
 5 Brazil       1999 cases           37737
 6 Brazil       1999 population  172006362
 7 Brazil       2000 cases           80488
 8 Brazil       2000 population  174504898
 9 China        1999 cases          212258
10 China        1999 population 1272915272
11 China        2000 cases          213766
12 China        2000 population 1280428583</code></pre>
</div>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Divided the type into cases and population</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>table2 <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> type, <span class="at">values_from =</span> count)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country      year  cases population
  &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;
1 Afghanistan  1999    745   19987071
2 Afghanistan  2000   2666   20595360
3 Brazil       1999  37737  172006362
4 Brazil       2000  80488  174504898
5 China        1999 212258 1272915272
6 China        2000 213766 1280428583</code></pre>
</div>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Original dataset of table3</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>table3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  country      year rate             
  &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;            
1 Afghanistan  1999 745/19987071     
2 Afghanistan  2000 2666/20595360    
3 Brazil       1999 37737/172006362  
4 Brazil       2000 80488/174504898  
5 China        1999 212258/1272915272
6 China        2000 213766/1280428583</code></pre>
</div>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate the rate into cases and population</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a>table3 <span class="sc">%&gt;%</span> <span class="fu">separate</span>(<span class="at">col =</span> rate, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"cases"</span>, <span class="st">"population"</span>), <span class="at">sep =</span> <span class="st">"/"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country      year cases  population
  &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;     
1 Afghanistan  1999 745    19987071  
2 Afghanistan  2000 2666   20595360  
3 Brazil       1999 37737  172006362 
4 Brazil       2000 80488  174504898 
5 China        1999 212258 1272915272
6 China        2000 213766 1280428583</code></pre>
</div>
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Original dataset of table4a and table4b</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(table4a, table4b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      country   1999   2000     country       1999       2000
1 Afghanistan    745   2666 Afghanistan   19987071   20595360
2      Brazil  37737  80488      Brazil  172006362  174504898
3       China 212258 213766       China 1272915272 1280428583</code></pre>
</div>
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Put table4a and table4b together to form a new table with both of their dataset</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>tidy4a_changed <span class="ot">&lt;-</span> table4a <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="fu">c</span>(<span class="st">`</span><span class="at">1999</span><span class="st">`</span>, <span class="st">`</span><span class="at">2000</span><span class="st">`</span>), <span class="at">names_to =</span> <span class="st">"year"</span>, <span class="at">values_to =</span> <span class="st">"cases"</span>)</span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>tidy4b_changed <span class="ot">&lt;-</span> table4b <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="fu">c</span>(<span class="st">`</span><span class="at">1999</span><span class="st">`</span>, <span class="st">`</span><span class="at">2000</span><span class="st">`</span>), <span class="at">names_to =</span> <span class="st">"year"</span>, <span class="at">values_to =</span> <span class="st">"population"</span>)</span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(tidy4a_changed, tidy4b_changed)   <span class="do">## Kind of like MySQL</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(country, year)`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country     year   cases population
  &lt;chr&gt;       &lt;chr&gt;  &lt;dbl&gt;      &lt;dbl&gt;
1 Afghanistan 1999     745   19987071
2 Afghanistan 2000    2666   20595360
3 Brazil      1999   37737  172006362
4 Brazil      2000   80488  174504898
5 China       1999  212258 1272915272
6 China       2000  213766 1280428583</code></pre>
</div>
</div>
</section>
<section id="find-missing-observations" class="level2">
<h2 class="anchored" data-anchor-id="find-missing-observations"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>6.7</strong></span> Find missing observations</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openair)</span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a><span class="co"># create a function to count missing observations</span></span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a>sum_of_na <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(<span class="fu">is.na</span>(x))</span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true" tabindex="-1"></a>mydata <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(</span>
<span id="cb196-8"><a href="#cb196-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">across</span>(<span class="fu">everything</span>(), sum_of_na)</span>
<span id="cb196-9"><a href="#cb196-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 10
   date    ws    wd   nox   no2    o3  pm10   so2    co  pm25
  &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
1     0   632   219  2423  2438  2589  2162 10450  1936  8775</code></pre>
</div>
</div>
</section>
</section>
<section id="anova-post-hoc-tests" class="level1">
<h1><span style="color:gray; font-family:Microsoft JhengHei;"><strong>7</strong></span> ANOVA (Post-hoc tests)</h1>
<section id="post-hoc-tests" class="level2">
<h2 class="anchored" data-anchor-id="post-hoc-tests"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>7.1</strong></span> Post-hoc tests</h2>
<p>Background informations: A biologist studies the weight gain of male lab rats on diets over a 4-week period. Three different diets are applied.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Statistic anlysis</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>(dtf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">diet1 =</span> <span class="fu">c</span>(<span class="dv">90</span>, <span class="dv">95</span>, <span class="dv">100</span>),</span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">diet2 =</span> <span class="fu">c</span>(<span class="dv">120</span>, <span class="dv">125</span>, <span class="dv">130</span>),</span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">diet3 =</span> <span class="fu">c</span>(<span class="dv">125</span>, <span class="dv">130</span>, <span class="dv">135</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  diet1 diet2 diet3
1    90   120   125
2    95   125   130
3   100   130   135</code></pre>
</div>
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>dtf2 <span class="ot">&lt;-</span> <span class="fu">stack</span>(dtf)</span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(dtf2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"wg"</span>, <span class="st">"diet"</span>)</span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>wg_aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(wg <span class="sc">~</span> diet, <span class="at">data =</span> dtf2)</span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wg_aov)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
diet         2   2150    1075      43 0.000277 ***
Residuals    6    150      25                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dtf2) <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(wg, diet))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="fishers-least-significant-difference-lsd-test" class="level2">
<h2 class="anchored" data-anchor-id="fishers-least-significant-difference-lsd-test"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>7.2</strong></span> Fisher’s Least Significant Difference (LSD) Test</h2>
<section id="concept" class="level3">
<h3 class="anchored" data-anchor-id="concept"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>7.2.1</strong></span> Concept</h3>
<p>Pair-wise comparisons of all the groups based on the <span class="math inline">\(t\)</span>-test: <span class="math display">\[L S D=t_{\alpha / 2} \sqrt{S_{p}^{2}\left(\frac{1}{n_1}+\frac{1}{n_2}+\cdots\right)}\]</span> <span class="math display">\[S_{p}^{2}=\frac{\left(n_{1}-1\right) S_{1}^{2}+\left(n_{2}-1\right) S_{2}^{2}+\left(n_{3}-1\right) S_{3}^{2}+\cdots}{\left(n_{1}-1\right)+\left(n_{2}-1\right)+\left(n_{3}-1\right)+\cdots}\]</span></p>
<ul>
<li><span class="math inline">\(S_{p}^{2}:\)</span>: pooled standard deviation (some use Mean Standard Error)</li>
<li><span class="math inline">\(t_{\alpha / 2}: \mathrm{t}\)</span>: <span class="math inline">\(t\)</span> critical value at <span class="math inline">\(\alpha=0.025\)</span></li>
<li>Degree of freedom: <span class="math inline">\(N - k\)</span>
<ul>
<li><span class="math inline">\(N\)</span>: total observations</li>
<li><span class="math inline">\(k\)</span>: number of factors</li>
</ul></li>
<li>If <span class="math inline">\(\left|\bar{x}_{1}-\bar{x}_{2}\right|&gt;L S D\)</span>, then the difference of <span class="math inline">\(x_1\)</span> group and <span class="math inline">\(x_2\)</span> group is significant at <span class="math inline">\(\alpha\)</span>.</li>
<li>In multiple comparisons (<span class="math inline">\(k\)</span> factors), the number of comparison needed is: <span class="math inline">\(\frac{k(k-1)}{2}\)</span></li>
</ul>
</section>
<section id="example" class="level3">
<h3 class="anchored" data-anchor-id="example"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>7.2.2</strong></span> Example</h3>
<p>(Rats on diets in the previous section)</p>
<ol type="1">
<li>Step by step</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate LSD</span></span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(dtf2)</span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">nlevels</span>(dtf2<span class="sc">$</span>diet)</span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a>dfree <span class="ot">&lt;-</span> n <span class="sc">-</span> k</span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a>t_critical <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fl">0.05</span><span class="sc">/</span><span class="dv">2</span>, <span class="at">df =</span> dfree, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb203-6"><a href="#cb203-6" aria-hidden="true" tabindex="-1"></a>sp2 <span class="ot">&lt;-</span> <span class="fu">sum</span>((<span class="dv">3</span> <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">apply</span>(dtf, <span class="dv">2</span>, sd) <span class="sc">^</span> <span class="dv">2</span>)<span class="sc">/</span> dfree</span>
<span id="cb203-7"><a href="#cb203-7" aria-hidden="true" tabindex="-1"></a>LSD <span class="ot">&lt;-</span> t_critical <span class="sc">*</span> <span class="fu">sqrt</span>(sp2 <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>))</span>
<span id="cb203-8"><a href="#cb203-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate |mean_x1-mean_x2|</span></span>
<span id="cb203-9"><a href="#cb203-9" aria-hidden="true" tabindex="-1"></a>dtf_groupmean <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(dtf)</span>
<span id="cb203-10"><a href="#cb203-10" aria-hidden="true" tabindex="-1"></a>paired_groupmean <span class="ot">&lt;-</span> <span class="fu">combn</span>(dtf_groupmean, <span class="dv">2</span>)</span>
<span id="cb203-11"><a href="#cb203-11" aria-hidden="true" tabindex="-1"></a>paired_groupmean[<span class="dv">2</span>, ] <span class="sc">-</span> paired_groupmean[<span class="dv">1</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 30 35  5</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Step by step by using loop</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a>dtf_sm <span class="ot">&lt;-</span> dtf2 <span class="sc">|&gt;</span> </span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(diet) <span class="sc">|&gt;</span> </span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">length</span>(wg), <span class="at">sd =</span> <span class="fu">sd</span>(wg), <span class="at">mean =</span> <span class="fu">mean</span>(wg))</span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true" tabindex="-1"></a>sp2 <span class="ot">&lt;-</span> <span class="fu">sum</span>((dtf_sm<span class="sc">$</span>n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> dtf_sm<span class="sc">$</span>sd <span class="sc">^</span> <span class="dv">2</span> )<span class="sc">/</span> dfree</span>
<span id="cb205-6"><a href="#cb205-6" aria-hidden="true" tabindex="-1"></a>LSD <span class="ot">&lt;-</span> t_critical <span class="sc">*</span> <span class="fu">sqrt</span>(sp2 <span class="sc">*</span> <span class="fu">sum</span>(<span class="dv">1</span> <span class="sc">/</span> dtf_sm<span class="sc">$</span>n))</span>
<span id="cb205-7"><a href="#cb205-7" aria-hidden="true" tabindex="-1"></a>paired_groupmean <span class="ot">&lt;-</span> <span class="fu">combn</span>(dtf_sm<span class="sc">$</span>mean, <span class="dv">2</span>)</span>
<span id="cb205-8"><a href="#cb205-8" aria-hidden="true" tabindex="-1"></a>paired_groupmean[<span class="dv">2</span>, ] <span class="sc">-</span> paired_groupmean[<span class="dv">1</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 30 35  5</code></pre>
</div>
</div>
<ol start="3" type="1">
<li>One step</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agricolae)</span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Statistic analysis</span></span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a><span class="fu">LSD.test</span>(wg_aov, <span class="st">"diet"</span>, <span class="at">p.adj =</span> <span class="st">"bonferroni"</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$statistics
  MSerror Df     Mean       CV  t.value      MSD
       25  6 116.6667 4.285714 3.287455 13.42098

$parameters
        test  p.ajusted name.t ntr alpha
  Fisher-LSD bonferroni   diet   3  0.05

$means
       wg std r       LCL      UCL Min Max   Q25 Q50   Q75
diet1  95   5 3  87.93637 102.0636  90 100  92.5  95  97.5
diet2 125   5 3 117.93637 132.0636 120 130 122.5 125 127.5
diet3 130   5 3 122.93637 137.0636 125 135 127.5 130 132.5

$comparison
NULL

$groups
       wg groups
diet3 130      a
diet2 125      a
diet1  95      b

attr(,"class")
[1] "group"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="fu">LSD.test</span>(wg_aov, <span class="st">"diet"</span>, <span class="at">p.adj =</span> <span class="st">"bonferroni"</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>Conclusion: At <span class="math inline">\(\alpha = 0.05\)</span>, Diet 2 and Diet 3 are significantly different from Diet 1 in the mean weight gain, while Diet 2 is not significantly different from Diet 3.</p>
</section>
</section>
<section id="bonferroni-t-test" class="level2">
<h2 class="anchored" data-anchor-id="bonferroni-t-test"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>7.3</strong></span> Bonferroni t-test</h2>
<section id="concept-1" class="level3">
<h3 class="anchored" data-anchor-id="concept-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>7.3.1</strong></span> Concept</h3>
<p>A multiple-comparison post-hoc test, which sets the significance cut off at <span class="math inline">\(\alpha/m\)</span> for each comparison, where <span class="math inline">\(m\)</span> represents <span style="color:red">the <u>number</u> of comparisons we apply</span>.</p>
<p><span style="color:#880000">Overall chance of making a Type I error:</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span></span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a>siglevel <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a>Type_I <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> (siglevel <span class="sc">/</span> m)) <span class="sc">^</span> m</span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true" tabindex="-1"></a>Type_I</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 0.05000000 0.04937500 0.04917130 0.04907029 0.04900995 0.04896984
  [7] 0.04894124 0.04891982 0.04890317 0.04888987 0.04887899 0.04886993
 [13] 0.04886227 0.04885571 0.04885002 0.04884504 0.04884065 0.04883675
 [19] 0.04883326 0.04883012 0.04882728 0.04882470 0.04882235 0.04882019
 [25] 0.04881820 0.04881637 0.04881467 0.04881309 0.04881162 0.04881025
 [31] 0.04880897 0.04880777 0.04880664 0.04880558 0.04880458 0.04880363
 [37] 0.04880274 0.04880189 0.04880109 0.04880033 0.04879960 0.04879891
 [43] 0.04879825 0.04879762 0.04879702 0.04879644 0.04879589 0.04879536
 [49] 0.04879486 0.04879437 0.04879390 0.04879346 0.04879302 0.04879261
 [55] 0.04879221 0.04879182 0.04879145 0.04879109 0.04879074 0.04879040
 [61] 0.04879008 0.04878976 0.04878946 0.04878916 0.04878888 0.04878860
 [67] 0.04878833 0.04878807 0.04878782 0.04878757 0.04878733 0.04878710
 [73] 0.04878687 0.04878665 0.04878644 0.04878623 0.04878602 0.04878583
 [79] 0.04878563 0.04878544 0.04878526 0.04878508 0.04878491 0.04878474
 [85] 0.04878457 0.04878441 0.04878425 0.04878409 0.04878394 0.04878379
 [91] 0.04878365 0.04878350 0.04878337 0.04878323 0.04878310 0.04878297
 [97] 0.04878284 0.04878271 0.04878259 0.04878247</code></pre>
</div>
</div>
</section>
<section id="example-1" class="level3">
<h3 class="anchored" data-anchor-id="example-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>7.3.2</strong></span> Example</h3>
<p>(Rats on diets in the previous section)</p>
<ol type="1">
<li>Step by step</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">choose</span>(<span class="fu">nlevels</span>(dtf2<span class="sc">$</span>diet), <span class="dv">2</span>)  <span class="co"># 1:2 or 1:3 or 2:3</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>alpha_cor <span class="ot">&lt;-</span> <span class="fl">0.05</span> <span class="sc">/</span> m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pairwise comparison between diet1 and diet2</span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(wg <span class="sc">~</span> diet, dtf2, <span class="at">subset =</span> diet <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"diet1"</span>, <span class="st">"diet2"</span>), <span class="at">conf.level =</span> <span class="dv">1</span> <span class="sc">-</span> alpha_cor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  wg by diet
t = -7.3485, df = 4, p-value = 0.001826
alternative hypothesis: true difference in means between group diet1 and group diet2 is not equal to 0
98.33333 percent confidence interval:
 -46.16984 -13.83016
sample estimates:
mean in group diet1 mean in group diet2 
                 95                 125 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pairwise comparison between diet1 and diet3</span></span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(wg <span class="sc">~</span> diet, dtf2, <span class="at">subset =</span> diet <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"diet1"</span>, <span class="st">"diet3"</span>), <span class="at">conf.level =</span> <span class="dv">1</span> <span class="sc">-</span> alpha_cor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  wg by diet
t = -8.5732, df = 4, p-value = 0.001017
alternative hypothesis: true difference in means between group diet1 and group diet3 is not equal to 0
98.33333 percent confidence interval:
 -51.16984 -18.83016
sample estimates:
mean in group diet1 mean in group diet3 
                 95                 130 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pairwise comparison between diet2 and diet3</span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(wg <span class="sc">~</span> diet, dtf2, <span class="at">subset =</span> diet <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"diet2"</span>, <span class="st">"diet3"</span>), <span class="at">conf.level =</span> <span class="dv">1</span> <span class="sc">-</span> alpha_cor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  wg by diet
t = -1.2247, df = 4, p-value = 0.2879
alternative hypothesis: true difference in means between group diet2 and group diet3 is not equal to 0
98.33333 percent confidence interval:
 -21.16984  11.16984
sample estimates:
mean in group diet2 mean in group diet3 
                125                 130 </code></pre>
</div>
</div>
<ol start="2" type="1">
<li>One step</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>(diet_pt <span class="ot">&lt;-</span> <span class="fu">pairwise.t.test</span>(dtf2<span class="sc">$</span>wg, dtf2<span class="sc">$</span>diet, <span class="at">pool.sd =</span> <span class="cn">FALSE</span>,<span class="at">var.equal =</span> <span class="cn">TRUE</span>, <span class="at">p.adj =</span> <span class="st">"none"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using t tests with non-pooled SD 

data:  dtf2$wg and dtf2$diet 

      diet1  diet2 
diet2 0.0018 -     
diet3 0.0010 0.2879

P value adjustment method: none </code></pre>
</div>
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a>diet_pt<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      diet1 diet2
diet2  TRUE    NA
diet3  TRUE FALSE</code></pre>
</div>
</div>
<p>Conclusion: At <span class="math inline">\(\alpha = 0.05\)</span>, Diet 2 and Diet 3 are significantly different from Diet 1 in the mean weight gain, while Diet 2 is not significantly different from Diet 3.</p>
</section>
</section>
</section>
<section id="manova" class="level1">
<h1><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8</strong></span> MANOVA</h1>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/One-Way%20ANOVA.jpg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">One-Way ANOVA (ENV221)</figcaption><p></p>
</figure>
</div>
</center>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Two-Way%20ANOVA.jpg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Two-Way ANOVA (ENV221)</figcaption><p></p>
</figure>
</div>
</center>
<center>
<a href="https://www.statology.org/differences-between-anova-ancova-manova-mancova/">The Differences Between ANOVA, ANCOVA, MANOVA, and MANCOVA</a>
</center>
<section id="definition-of-manova" class="level2">
<h2 class="anchored" data-anchor-id="definition-of-manova"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.1</strong></span> Definition of MANOVA</h2>
<p><strong>Univariate Analysis of Variance (ANOVA):</strong> - one dependent variable (continuous) ~ one or multiple independent variables (categorical).<br>
<strong>Multivariate Analysis of Variance (MANOVA)</strong> - multiple dependent variables (continuous) ~ one or multiple independent variables (categorical).<br>
Comparing multivariate sample means. It uses the covariance between outcome variables in testing the statistical significance of the mean differences when there are multiple dependent variables.<br>
Merit of MANOVA: 1. Reduce the Type I error 2. It allows for the analysis of multiple dependent variables simultaneously 3. It provides information about the strength and direction of relationships</p>
</section>
<section id="coding-and-visualization" class="level2">
<h2 class="anchored" data-anchor-id="coding-and-visualization"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.2</strong></span> Coding and visualization</h2>
<p><strong>Example:</strong> Influence of <u>teaching methods</u> on student <u>satisfaction scores</u> and <u>exam scores</u>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a>dtf <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'data/teaching_methods.csv'</span>)</span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dtf, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Method  Test Satisfaction
1      1 3.000        3.001
2      1 2.990        2.994
3      1 3.041        3.032</code></pre>
</div>
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ANOVA between Test and Method</span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(Test <span class="sc">~</span> Method, <span class="at">data =</span> dtf))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df   Sum Sq   Mean Sq F value Pr(&gt;F)
Method       1 0.000578 0.0005780   2.426  0.126
Residuals   46 0.010958 0.0002382               </code></pre>
</div>
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ANOVA between Satisfaction and Method</span></span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(Satisfaction <span class="sc">~</span> Method, <span class="at">data =</span> dtf))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df   Sum Sq   Mean Sq F value Pr(&gt;F)
Method       1 0.000032 0.0000320   0.135  0.715
Residuals   46 0.010944 0.0002379               </code></pre>
</div>
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization with Scatter plot</span></span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a>dtf <span class="sc">|&gt;</span> <span class="fu">pivot_longer</span>(<span class="sc">-</span>Method) <span class="sc">|&gt;</span> </span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb229-6"><a href="#cb229-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Method, <span class="at">y =</span> value, <span class="at">group =</span> Method), <span class="at">binaxis =</span> <span class="st">"y"</span>, <span class="at">stackdir =</span> <span class="st">"center"</span>) <span class="sc">+</span> </span>
<span id="cb229-7"><a href="#cb229-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(name<span class="sc">~</span>.)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Bin width defaults to 1/30 of the range of the data. Pick better value with
`binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization with Box plot</span></span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(Test <span class="sc">~</span> Method, <span class="at">data =</span> dtf)</span>
<span id="cb231-4"><a href="#cb231-4" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(Satisfaction <span class="sc">~</span> Method, <span class="at">data =</span> dtf)</span>
<span id="cb231-5"><a href="#cb231-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dtf<span class="sc">$</span>Satisfaction, dtf<span class="sc">$</span>Test, <span class="at">col =</span> dtf<span class="sc">$</span>Method, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">xlab =</span> <span class="st">'Satisfaction'</span>, <span class="at">ylab =</span> <span class="st">'Test'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-37-2.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="co"># MANOVA method: use manova() function with multiple response variables ~ one or multiple factor</span></span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a><span class="co"># column bind way</span></span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a>tm_manova <span class="ot">&lt;-</span> <span class="fu">manova</span>(<span class="fu">cbind</span>(dtf<span class="sc">$</span>Test, dtf<span class="sc">$</span>Satisfaction) <span class="sc">~</span> dtf<span class="sc">$</span>Method)</span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a><span class="co"># matrix way</span></span>
<span id="cb232-5"><a href="#cb232-5" aria-hidden="true" tabindex="-1"></a>tm_manova <span class="ot">&lt;-</span> <span class="fu">manova</span>(<span class="fu">as.matrix</span>(dtf[, <span class="fu">c</span>(<span class="st">'Test'</span>, <span class="st">'Satisfaction'</span>)]) <span class="sc">~</span> dtf<span class="sc">$</span>Method)</span>
<span id="cb232-6"><a href="#cb232-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tm_manova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Df  Pillai approx F num Df den Df   Pr(&gt;F)    
dtf$Method  1 0.45766   18.987      2     45 1.05e-06 ***
Residuals  46                                            
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="one-way-manova" class="level2">
<h2 class="anchored" data-anchor-id="one-way-manova"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.3</strong></span> One-way MANOVA</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/One-way%20MANOVA.jpg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">One-way MANOVA</figcaption><p></p>
</figure>
</div>
</center>
<p><strong>Example:</strong> The iris dataset. Do the species have influence on the sepal size?</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a>iris[, <span class="fu">c</span>(<span class="st">'Species'</span>, <span class="st">'Sepal.Length'</span>, <span class="st">'Sepal.Width'</span>)] <span class="sc">|&gt;</span> </span>
<span id="cb234-5"><a href="#cb234-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(Sepal.Length, Sepal.Width)) <span class="sc">|&gt;</span> </span>
<span id="cb234-6"><a href="#cb234-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb234-7"><a href="#cb234-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(Species, value, <span class="at">fill =</span> name)) <span class="sc">+</span></span>
<span id="cb234-8"><a href="#cb234-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Size (cm)'</span>, <span class="at">fill =</span> <span class="st">''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gplots)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gplots'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    lowess</code></pre>
</div>
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plotmeans</span>(iris<span class="sc">$</span>Sepal.Length <span class="sc">~</span> iris<span class="sc">$</span>Species)</span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plotmeans</span>(iris<span class="sc">$</span>Sepal.Width <span class="sc">~</span> iris<span class="sc">$</span>Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-38-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Hypothesis:</strong> multivariate normality test - <span class="math inline">\(H_0\)</span>: The population means of the sepal length and the sepal width are not different across the species.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary MANOVA result with different test method</span></span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a>SepalSize <span class="ot">&lt;-</span> <span class="fu">cbind</span>(iris<span class="sc">$</span>Sepal.Length, iris<span class="sc">$</span>Sepal.Width)</span>
<span id="cb239-3"><a href="#cb239-3" aria-hidden="true" tabindex="-1"></a>iris_manova <span class="ot">&lt;-</span> <span class="fu">manova</span>(SepalSize <span class="sc">~</span> iris<span class="sc">$</span>Species)</span>
<span id="cb239-4"><a href="#cb239-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iris_manova, <span class="at">test =</span> <span class="st">'Pillai'</span>)  <span class="co"># default</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Df  Pillai approx F num Df den Df    Pr(&gt;F)    
iris$Species   2 0.94531   65.878      4    294 &lt; 2.2e-16 ***
Residuals    147                                             
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iris_manova, <span class="at">test =</span> <span class="st">'Wilks'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Df   Wilks approx F num Df den Df    Pr(&gt;F)    
iris$Species   2 0.16654   105.88      4    292 &lt; 2.2e-16 ***
Residuals    147                                             
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iris_manova, <span class="at">test =</span> <span class="st">'Roy'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Df    Roy approx F num Df den Df    Pr(&gt;F)    
iris$Species   2 4.1718   306.63      2    147 &lt; 2.2e-16 ***
Residuals    147                                            
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iris_manova, <span class="at">test =</span> <span class="st">'Hotelling-Lawley'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Df Hotelling-Lawley approx F num Df den Df    Pr(&gt;F)    
iris$Species   2           4.3328   157.06      4    290 &lt; 2.2e-16 ***
Residuals    147                                                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Univariate ANOVAs for each dependent variable</span></span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.aov</span>(iris_manova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Response 1 :
              Df Sum Sq Mean Sq F value    Pr(&gt;F)    
iris$Species   2 63.212  31.606  119.26 &lt; 2.2e-16 ***
Residuals    147 38.956   0.265                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

 Response 2 :
              Df Sum Sq Mean Sq F value    Pr(&gt;F)    
iris$Species   2 11.345  5.6725   49.16 &lt; 2.2e-16 ***
Residuals    147 16.962  0.1154                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><strong>Conclusion:</strong> The species has a statistically significant effect on the sepal width and sepal length.</p>
</section>
<section id="post-hoc-test" class="level2">
<h2 class="anchored" data-anchor-id="post-hoc-test"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.4</strong></span> Post-hoc test</h2>
<p><strong>Example:</strong> after One-way MANOVA gives a significant result, which group(s) is/are different from other(s)?<br>
<strong>Hypothesis:</strong> Linear Discriminant Analysis (LDA)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'MASS'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    select</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:patchwork':

    area</code></pre>
</div>
<div class="sourceCode cell-code" id="cb253"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a>iris_lda <span class="ot">&lt;-</span> <span class="fu">lda</span>(iris<span class="sc">$</span>Species <span class="sc">~</span> SepalSize, <span class="at">CV =</span> <span class="cn">FALSE</span>)</span>
<span id="cb253-2"><a href="#cb253-2" aria-hidden="true" tabindex="-1"></a>plot_lda <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Species =</span> iris<span class="sc">$</span>Species, <span class="at">lda =</span> <span class="fu">predict</span>(iris_lda)<span class="sc">$</span>x)</span>
<span id="cb253-3"><a href="#cb253-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plot_lda) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> lda.LD1, <span class="at">y =</span> lda.LD2, <span class="at">colour =</span> Species))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Conclusion:</strong> The sepal size of the setosa species is different from other species.</p>
</section>
<section id="multivariate-normality" class="level2">
<h2 class="anchored" data-anchor-id="multivariate-normality"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.5</strong></span> Multivariate normality</h2>
<section id="shapiro-wilk-test" class="level3">
<h3 class="anchored" data-anchor-id="shapiro-wilk-test"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.5.1</strong></span> Shapiro-Wilk test</h3>
<p><strong>Hypothesis:</strong><br>
<span class="math inline">\(H_0\)</span>: The variable follows a normal distribution</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'rstatix'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:MASS':

    select</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    filter</code></pre>
</div>
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span>  </span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Species) <span class="sc">|&gt;</span>  </span>
<span id="cb258-3"><a href="#cb258-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(Sepal.Length, Sepal.Width)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  Species    variable     statistic     p
  &lt;fct&gt;      &lt;chr&gt;            &lt;dbl&gt; &lt;dbl&gt;
1 setosa     Sepal.Length     0.978 0.460
2 setosa     Sepal.Width      0.972 0.272
3 versicolor Sepal.Length     0.978 0.465
4 versicolor Sepal.Width      0.974 0.338
5 virginica  Sepal.Length     0.971 0.258
6 virginica  Sepal.Width      0.967 0.181</code></pre>
</div>
</div>
<p>Tip:</p>
<ul>
<li><span style="color:green">If the sample size is large (say n &gt; 50), the visual approaches such as QQ-plot and histogram will be better for assessing the normality assumption.</span></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a>iris[, <span class="fu">c</span>(<span class="st">'Species'</span>, <span class="st">'Sepal.Length'</span>, <span class="st">'Sepal.Width'</span>)] <span class="sc">|&gt;</span> </span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(Sepal.Length, Sepal.Width)) <span class="sc">|&gt;</span> </span>
<span id="cb260-3"><a href="#cb260-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb260-4"><a href="#cb260-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(value)) <span class="sc">+</span></span>
<span id="cb260-5"><a href="#cb260-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(name <span class="sc">~</span> Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Conclusion:</strong> As <span class="math inline">\(p&gt;0.05\)</span>, the sepal length and the width for each species are normally distributed.</p>
</section>
<section id="mardias-skewness-and-kurtosis-test" class="level3">
<h3 class="anchored" data-anchor-id="mardias-skewness-and-kurtosis-test"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.5.2</strong></span> Mardia’s skewness and kurtosis test</h3>
<p><strong>Hypothesis:</strong><br>
<span class="math inline">\(H_0\)</span>: The variables follow a multivariate normal distribution</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb262"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvnormalTest)</span>
<span id="cb262-2"><a href="#cb262-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mardia</span>(iris[, <span class="fu">c</span>(<span class="st">'Sepal.Length'</span>, <span class="st">'Sepal.Width'</span>)])<span class="sc">$</span>mv.test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Test Statistic p-value Result
1     Skewness    9.4614  0.0505    YES
2     Kurtosis    -0.691  0.4896    YES
3 MV Normality      &lt;NA&gt;    &lt;NA&gt;    YES</code></pre>
</div>
</div>
<p>Tip:</p>
<ul>
<li><span style="color:green">When n &gt; 20 for each combination of the independent and dependent variable, the multivariate normality can be assumed (Multivariate Central Limit Theorem).</span></li>
</ul>
<p><strong>Conclusion:</strong> As <span class="math inline">\(p&gt;0.05\)</span>, the sepal length and the width follow a multivariate normal distribution.</p>
</section>
<section id="homogeneity-of-the-variance-covariance-matrix" class="level3">
<h3 class="anchored" data-anchor-id="homogeneity-of-the-variance-covariance-matrix"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.5.3</strong></span> Homogeneity of the variance-covariance matrix</h3>
<p><strong>Main:</strong><br>
Box’s M test: Use a lower <span class="math inline">\(\alpha\)</span> level such as <span class="math inline">\(\alpha = 0.001\)</span> to assess the <span class="math inline">\(p\)</span> value for significance.<br>
<strong>Hypothesis:</strong><br>
<span class="math inline">\(H_0\)</span>: The variance-covariance matrices are equal for each combination formed by each group in the independent variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(biotools)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>---
biotools version 4.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxM</span>(<span class="fu">cbind</span>(iris<span class="sc">$</span>Sepal.Length, iris<span class="sc">$</span>Sepal.Width), iris<span class="sc">$</span>Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Box's M-test for Homogeneity of Covariance Matrices

data:  cbind(iris$Sepal.Length, iris$Sepal.Width)
Chi-Sq (approx.) = 35.655, df = 6, p-value = 3.217e-06</code></pre>
</div>
</div>
<p><strong>Conclusion:</strong> As <span class="math inline">\(p &lt; 0.001\)</span>, the variance-covariance matrices for the sepal length and width are not equal for each combination formed by each species.</p>
</section>
<section id="multivariate-outliers" class="level3">
<h3 class="anchored" data-anchor-id="multivariate-outliers"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.5.4</strong></span> Multivariate outliers</h3>
<ul>
<li><span style="color:red">MANOVA is highly sensitive to outliers and may produce Type I or II errors.</span></li>
<li>Multivariate outliers can be detected using the Mahalanobis Distance test. The larger the Mahalanobis Distance, the more likely it is an outlier.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true" tabindex="-1"></a>iris_outlier <span class="ot">&lt;-</span> <span class="fu">mahalanobis_distance</span>(iris[, <span class="fu">c</span>(<span class="st">'Sepal.Length'</span>, <span class="st">'Sepal.Width'</span>)])</span>
<span id="cb268-3"><a href="#cb268-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(iris_outlier, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width mahal.dist is.outlier
1          5.1         3.5      1.646      FALSE
2          4.9         3.0      1.369      FALSE
3          4.7         3.2      1.934      FALSE
4          4.6         3.1      2.261      FALSE
5          5.0         3.6      2.321      FALSE</code></pre>
</div>
</div>
</section>
<section id="linearity" class="level3">
<h3 class="anchored" data-anchor-id="linearity"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.5.5</strong></span> Linearity</h3>
<ul>
<li>Or test the regression or the slope (ENV221)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the pairwise scatterplot for the dependent variable for each group</span></span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Sepal.Width)) <span class="sc">+</span></span>
<span id="cb270-3"><a href="#cb270-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb270-4"><a href="#cb270-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>) <span class="sc">+</span></span>
<span id="cb270-5"><a href="#cb270-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Species <span class="sc">~</span> .)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="multicollinearity" class="level3">
<h3 class="anchored" data-anchor-id="multicollinearity"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.5.6</strong></span> Multicollinearity</h3>
<p>Correlation between the dependent variable.<br>
For three or more dependent variables, use a correlation matrix or variance inflation factor (VIF).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test the correlation</span></span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(<span class="at">x =</span> iris<span class="sc">$</span>Sepal.Length, <span class="at">y =</span> iris<span class="sc">$</span>Sepal.Width)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  iris$Sepal.Length and iris$Sepal.Width
t = -1.4403, df = 148, p-value = 0.1519
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.27269325  0.04351158
sample estimates:
       cor 
-0.1175698 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Sepal.Width)) <span class="sc">+</span></span>
<span id="cb274-3"><a href="#cb274-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb274-4"><a href="#cb274-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li>If <span class="math inline">\(|r|\)</span> &gt; 0.9, there is multicollinearity.</li>
<li>If r is too low, perform separate univariate ANOVA for each dependent variable.</li>
</ul>
</section>
</section>
<section id="two-way-manova" class="level2">
<h2 class="anchored" data-anchor-id="two-way-manova"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.6</strong></span> Two-way MANOVA</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Two-way%20MANOVA.jpg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Two-way MANOVA</figcaption><p></p>
</figure>
</div>
</center>
<p><strong>Example:</strong> Plastic. Do the rate of extrusion and the additive have influence on the plastic quality?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary MANOVA result</span></span>
<span id="cb276-2"><a href="#cb276-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">'Plastic'</span>, <span class="at">package =</span> <span class="st">'heplots'</span>)</span>
<span id="cb276-3"><a href="#cb276-3" aria-hidden="true" tabindex="-1"></a>Plastic_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(Plastic[, <span class="fu">c</span>(<span class="st">'tear'</span>,<span class="st">'gloss'</span>,<span class="st">'opacity'</span>)])</span>
<span id="cb276-4"><a href="#cb276-4" aria-hidden="true" tabindex="-1"></a>Plastic_manova <span class="ot">&lt;-</span> <span class="fu">manova</span>(Plastic_matrix <span class="sc">~</span> Plastic<span class="sc">$</span>rate <span class="sc">*</span> Plastic<span class="sc">$</span>additive)</span>
<span id="cb276-5"><a href="#cb276-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Plastic_manova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                              Df  Pillai approx F num Df den Df   Pr(&gt;F)   
Plastic$rate                   1 0.61814   7.5543      3     14 0.003034 **
Plastic$additive               1 0.47697   4.2556      3     14 0.024745 * 
Plastic$rate:Plastic$additive  1 0.22289   1.3385      3     14 0.301782   
Residuals                     16                                           
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Univariate ANOVAs for each dependent variable</span></span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.aov</span>(Plastic_manova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Response tear :
                              Df Sum Sq Mean Sq F value   Pr(&gt;F)   
Plastic$rate                   1 1.7405 1.74050 15.7868 0.001092 **
Plastic$additive               1 0.7605 0.76050  6.8980 0.018330 * 
Plastic$rate:Plastic$additive  1 0.0005 0.00050  0.0045 0.947143   
Residuals                     16 1.7640 0.11025                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

 Response gloss :
                              Df Sum Sq Mean Sq F value  Pr(&gt;F)  
Plastic$rate                   1 1.3005 1.30050  7.9178 0.01248 *
Plastic$additive               1 0.6125 0.61250  3.7291 0.07139 .
Plastic$rate:Plastic$additive  1 0.5445 0.54450  3.3151 0.08740 .
Residuals                     16 2.6280 0.16425                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

 Response opacity :
                              Df Sum Sq Mean Sq F value Pr(&gt;F)
Plastic$rate                   1  0.421  0.4205  0.1036 0.7517
Plastic$additive               1  4.901  4.9005  1.2077 0.2881
Plastic$rate:Plastic$additive  1  3.960  3.9605  0.9760 0.3379
Residuals                     16 64.924  4.0578               </code></pre>
</div>
</div>
</section>
</section>
<section id="ancova" class="level1">
<h1><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9</strong></span> ANCOVA</h1>
<section id="definition-of-ancova" class="level2">
<h2 class="anchored" data-anchor-id="definition-of-ancova"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.1</strong></span> Definition of ANCOVA</h2>
<p><span style="color:red">Test whether the independent variable(s) has a significant influence on the dependent variable, excluding the influence of the covariate (preferably highly correlated with the dependent variable)</span> <span class="math display">\[Y_{ij} = (\mu+\tau_{i})+\beta(x_{ij}-\bar{x})+\epsilon_{ij}\]</span></p>
<ul>
<li><span class="math inline">\(Y_{ij}\)</span>: the j-th observation under the i-th categorical group</li>
<li><span class="math inline">\(\mu\)</span>: the population mean</li>
<li><span class="math inline">\(i\)</span>: groups, 1,2, …</li>
<li><span class="math inline">\(j\)</span>: observations, 1,2,…</li>
<li><span class="math inline">\(\tau_i\)</span>: an adjustment to the y intercept for the i-th regression line</li>
<li><span class="math inline">\(\mu + \tau_i\)</span>: the intercept for group i</li>
<li><span class="math inline">\(\beta\)</span>: the slope of the line</li>
<li><span class="math inline">\(x_{ij}\)</span>: the j-th observation of the continuous variable under the i-th group</li>
<li><span class="math inline">\(\bar x\)</span>: the global mean of the variable x</li>
<li><span class="math inline">\(\epsilon _{ij}\)</span>: the associated unobserved error</li>
</ul>
<p><strong>Analysis of covariance (ANCOVA):</strong></p>
<ul>
<li>Dependent variable (DV): One continuous variable</li>
<li>Independent variables (IVs): One or multiple categorical variables, one or multiple continuous variables (covariate, CV)</li>
</ul>
<p><strong>Covariate (CV):</strong></p>
<ul>
<li>An independent variable that is not manipulated by experimenters but still influences experimental results.</li>
</ul>
<p><strong>Example:</strong></p>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/ANCOVA-plot.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Model simplification</figcaption><p></p>
</figure>
</div>
</center>
</section>
<section id="one-way-ancova" class="level2">
<h2 class="anchored" data-anchor-id="one-way-ancova"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.2</strong></span> One-way ANCOVA</h2>
<section id="question" class="level3">
<h3 class="anchored" data-anchor-id="question"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.2.1</strong></span> Question</h3>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/One-Way%20ANOVA.jpg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">One-Way ANCOVA</figcaption><p></p>
</figure>
</div>
</center>
<p><strong>Example 1:</strong> Does <u>grazing</u> have influence on the fruit production? Are grazed plants have more fruit <u>production</u> than ungrazed ones?</p>
<ul>
<li>Independent variable:
<ul>
<li>Grazing (categorical)</li>
</ul></li>
<li>Dependent variable:
<ul>
<li>Fruit production (continuous)</li>
</ul></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"data/ipomopsis.txt"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb280-2"><a href="#cb280-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df1, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Root Fruit  Grazing
1 6.225 59.77 Ungrazed
2 6.487 60.98 Ungrazed
3 4.919 14.73 Ungrazed
4 5.130 19.28 Ungrazed
5 5.417 34.25 Ungrazed</code></pre>
</div>
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(df1<span class="sc">$</span>Fruit,df1<span class="sc">$</span>Grazing, mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Grazed Ungrazed 
 67.9405  50.8805 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df1) <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(Fruit, Grazing))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb285"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Hypothesis test</span></span>
<span id="cb285-2"><a href="#cb285-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(Fruit <span class="sc">~</span> Grazing, <span class="at">data =</span> df1, <span class="at">alternative =</span> <span class="fu">c</span>(<span class="st">"greater"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  Fruit by Grazing
t = 2.304, df = 37.306, p-value = 0.01344
alternative hypothesis: true difference in means between group Grazed and group Ungrazed is greater than 0
95 percent confidence interval:
 4.570757      Inf
sample estimates:
  mean in group Grazed mean in group Ungrazed 
               67.9405                50.8805 </code></pre>
</div>
</div>
<p><strong>Example 2:</strong> What is the influence of <u>grazing</u> and <u>root diameter</u> on the fruit production of a plant?</p>
<p>Independent variables:</p>
<ul>
<li>grazing (categorical: grazed or ungrazed)</li>
<li>root diameter (continuous, mm, covariate)</li>
</ul>
<p>Dependent variable:</p>
<ul>
<li>fruit production (mg)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb287"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb287-2"><a href="#cb287-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df1, <span class="fu">aes</span>(Root, Fruit))<span class="sc">+</span></span>
<span id="cb287-3"><a href="#cb287-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb287-4"><a href="#cb287-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>) <span class="sc">+</span></span>
<span id="cb287-5"><a href="#cb287-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Grazing)) <span class="sc">+</span> </span>
<span id="cb287-6"><a href="#cb287-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">color =</span> Grazing), <span class="at">method =</span> <span class="st">'lm'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="maximal-model" class="level3">
<h3 class="anchored" data-anchor-id="maximal-model"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.2.2</strong></span> Maximal model</h3>
<table class="table">
<colgroup>
<col style="width: 45%">
<col style="width: 54%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Symbol</th>
<th style="text-align: left;">Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code>~</code></td>
<td style="text-align: left;">Separating DV (<span style="color:red">left</span>) and IV (<span style="color:red">right</span>)</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>:</code></td>
<td style="text-align: left;">Interaction effect of two factors</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>*</code></td>
<td style="text-align: left;">Main effect of the two factors and the interaction effect. <code>f1 * f2</code> is equivalent to <code>f1 + f2 + f1:f2</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>^</code></td>
<td style="text-align: left;">Square the sum of several terms. The main effect of these terms and the interaction between them</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>.</code></td>
<td style="text-align: left;">All variables except the DV</td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb289"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The maximal model</span></span>
<span id="cb289-2"><a href="#cb289-2" aria-hidden="true" tabindex="-1"></a>df1_ancova <span class="ot">&lt;-</span> <span class="fu">lm</span>(Fruit <span class="sc">~</span> Grazing <span class="sc">*</span> Root, <span class="at">data =</span> df1)</span>
<span id="cb289-3"><a href="#cb289-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df1_ancova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Fruit ~ Grazing * Root, data = df1)

Residuals:
     Min       1Q   Median       3Q      Max 
-17.3177  -2.8320   0.1247   3.8511  17.1313 

Coefficients:
                     Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)          -125.173     12.811  -9.771 1.15e-11 ***
GrazingUngrazed        30.806     16.842   1.829   0.0757 .  
Root                   23.240      1.531  15.182  &lt; 2e-16 ***
GrazingUngrazed:Root    0.756      2.354   0.321   0.7500    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.831 on 36 degrees of freedom
Multiple R-squared:  0.9293,    Adjusted R-squared:  0.9234 
F-statistic: 157.6 on 3 and 36 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb291"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The ANOVA table for the maximal model</span></span>
<span id="cb291-2"><a href="#cb291-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(df1_ancova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Fruit
             Df  Sum Sq Mean Sq  F value    Pr(&gt;F)    
Grazing       1  2910.4  2910.4  62.3795 2.262e-09 ***
Root          1 19148.9 19148.9 410.4201 &lt; 2.2e-16 ***
Grazing:Root  1     4.8     4.8   0.1031      0.75    
Residuals    36  1679.6    46.7                       
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb293"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="co"># other method to see the ANOVA table </span></span>
<span id="cb293-2"><a href="#cb293-2" aria-hidden="true" tabindex="-1"></a>df1_aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(Fruit <span class="sc">~</span> Grazing <span class="sc">*</span> Root, <span class="at">data =</span> df1)</span>
<span id="cb293-3"><a href="#cb293-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df1_aov)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
Grazing       1   2910    2910  62.380 2.26e-09 ***
Root          1  19149   19149 410.420  &lt; 2e-16 ***
Grazing:Root  1      5       5   0.103     0.75    
Residuals    36   1680      47                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb295"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.aov</span>(df1_ancova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
Grazing       1   2910    2910  62.380 2.26e-09 ***
Root          1  19149   19149 410.420  &lt; 2e-16 ***
Grazing:Root  1      5       5   0.103     0.75    
Residuals    36   1680      47                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="minimal-model" class="level3">
<h3 class="anchored" data-anchor-id="minimal-model"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.2.3</strong></span> Minimal model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Delete the interaction factor </span></span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a>df1_ancova2 <span class="ot">&lt;-</span> <span class="fu">update</span>(df1_ancova, <span class="sc">~</span> . <span class="sc">-</span> Grazing<span class="sc">:</span>Root)</span>
<span id="cb297-3"><a href="#cb297-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df1_ancova2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Fruit ~ Grazing + Root, data = df1)

Residuals:
     Min       1Q   Median       3Q      Max 
-17.1920  -2.8224   0.3223   3.9144  17.3290 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     -127.829      9.664  -13.23 1.35e-15 ***
GrazingUngrazed   36.103      3.357   10.75 6.11e-13 ***
Root              23.560      1.149   20.51  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.747 on 37 degrees of freedom
Multiple R-squared:  0.9291,    Adjusted R-squared:  0.9252 
F-statistic: 242.3 on 2 and 37 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb299"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare the simplified model with the maximal model</span></span>
<span id="cb299-2"><a href="#cb299-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(df1_ancova, df1_ancova2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: Fruit ~ Grazing * Root
Model 2: Fruit ~ Grazing + Root
  Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)
1     36 1679.7                           
2     37 1684.5 -1   -4.8122 0.1031   0.75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb301"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Delete the grazing factor </span></span>
<span id="cb301-2"><a href="#cb301-2" aria-hidden="true" tabindex="-1"></a>df1_ancova3 <span class="ot">&lt;-</span> <span class="fu">update</span>(df1_ancova2, <span class="sc">~</span> . <span class="sc">-</span> Grazing)</span>
<span id="cb301-3"><a href="#cb301-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df1_ancova3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Fruit ~ Root, data = df1)

Residuals:
     Min       1Q   Median       3Q      Max 
-29.3844 -10.4447  -0.7574  10.7606  23.7556 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -41.286     10.723  -3.850 0.000439 ***
Root          14.022      1.463   9.584  1.1e-11 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 13.52 on 38 degrees of freedom
Multiple R-squared:  0.7073,    Adjusted R-squared:  0.6996 
F-statistic: 91.84 on 1 and 38 DF,  p-value: 1.099e-11</code></pre>
</div>
<div class="sourceCode cell-code" id="cb303"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare the two models</span></span>
<span id="cb303-2"><a href="#cb303-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(df1_ancova2, df1_ancova3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: Fruit ~ Grazing + Root
Model 2: Fruit ~ Root
  Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
1     37 1684.5                                  
2     38 6948.8 -1   -5264.4 115.63 6.107e-13 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb305"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df1_ancova2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Fruit ~ Grazing + Root, data = df1)

Residuals:
     Min       1Q   Median       3Q      Max 
-17.1920  -2.8224   0.3223   3.9144  17.3290 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     -127.829      9.664  -13.23 1.35e-15 ***
GrazingUngrazed   36.103      3.357   10.75 6.11e-13 ***
Root              23.560      1.149   20.51  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.747 on 37 degrees of freedom
Multiple R-squared:  0.9291,    Adjusted R-squared:  0.9252 
F-statistic: 242.3 on 2 and 37 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb307"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(df1_ancova2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Fruit
          Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
Grazing    1  2910.4  2910.4  63.929 1.397e-09 ***
Root       1 19148.9 19148.9 420.616 &lt; 2.2e-16 ***
Residuals 37  1684.5    45.5                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="one-step" class="level3">
<h3 class="anchored" data-anchor-id="one-step"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.2.4</strong></span> One step</h3>
<p>Criterion: Akaike’s information criterion (AIC). The model is <u>worse</u> if AIC gets <u>greater</u>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb309"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="fu">step</span>(df1_ancova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=157.5
Fruit ~ Grazing * Root

               Df Sum of Sq    RSS    AIC
- Grazing:Root  1    4.8122 1684.5 155.61
&lt;none&gt;                      1679.7 157.50

Step:  AIC=155.61
Fruit ~ Grazing + Root

          Df Sum of Sq     RSS    AIC
&lt;none&gt;                  1684.5 155.61
- Grazing  1    5264.4  6948.8 210.30
- Root     1   19148.9 20833.4 254.22</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Fruit ~ Grazing + Root, data = df1)

Coefficients:
    (Intercept)  GrazingUngrazed             Root  
        -127.83            36.10            23.56  </code></pre>
</div>
</div>
</section>
<section id="result" class="level3">
<h3 class="anchored" data-anchor-id="result"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.2.5</strong></span> Result</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb312"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting formulas from linear regression models</span></span>
<span id="cb312-2"><a href="#cb312-2" aria-hidden="true" tabindex="-1"></a>equatiomatic<span class="sc">::</span><span class="fu">extract_eq</span>(df1_ancova2, <span class="at">use_coefs =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><span class="math display">\[
\operatorname{\widehat{Fruit}} = -127.83 + 36.1(\operatorname{Grazing}_{\operatorname{Ungrazed}}) + 23.56(\operatorname{Root})
\]</span></p>
</div>
</div>
<p><a id="diagnostic statistical data text table" href=""></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb313"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a diagnostic statistical data text table</span></span>
<span id="cb313-2"><a href="#cb313-2" aria-hidden="true" tabindex="-1"></a>stargazer<span class="sc">::</span><span class="fu">stargazer</span>(df1_ancova2, <span class="at">type =</span> <span class="st">'text'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
===============================================
                        Dependent variable:    
                    ---------------------------
                               Fruit           
-----------------------------------------------
GrazingUngrazed              36.103***         
                              (3.357)          
                                               
Root                         23.560***         
                              (1.149)          
                                               
Constant                    -127.829***        
                              (9.664)          
                                               
-----------------------------------------------
Observations                    40             
R2                             0.929           
Adjusted R2                    0.925           
Residual Std. Error       6.747 (df = 37)      
F Statistic           242.272*** (df = 2; 37)  
===============================================
Note:               *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
<details>
<summary>
The meaning of each parameter in this table
</summary>
<ul>
<li>Dependent variable: The name of the dependent variable.</li>
<li>Independent variables: The names of the independent variables.</li>
<li>Coefficients: Regression coefficients, indicating the degree to which an independent variable affects the dependent variable when it increases by one unit.</li>
<li>Standard errors: Standard error of regression coefficients, measuring the stability of regression coefficients.</li>
<li>t-statistics: t-value of regression coefficients, representing whether a regression coefficient is significantly different from zero and has a significant impact on the dependent variable.</li>
<li>p-values: Significance level of regression coefficients, usually used to determine whether a regression coefficient is significantly different from zero. The smaller the p-value, the more significant the regression coefficient is considered to be.</li>
<li>Observations: Sample size.</li>
<li>R2: Goodness-of-fit measure that represents how much variance in explanatory variables can be explained by model. A higher value indicates better fit between model and data</li>
<li>Adjusted R2：A modified version of R2 that takes into account number of independent variables for greater accuracy</li>
<li>Residual standard error：Standard deviation or dispersion measure for residuals; smaller values indicate better model fit</li>
<li>F-statistic：Statistical test used to evaluate overall goodness-of-fit for linear models</li>
<li>df：Degrees of freedom</li>
<li>Note:p&lt;0.1,p&lt;0.05,p&lt;0.01 : When p-value is less than 0.1, 0.05 or 0.01 respectively,* , ** , *** are used as symbols indicating significance levels for corresponding regressionscoefficients</li>
</ul>
</details>
</section>
</section>
<section id="two-way-ancova" class="level2">
<h2 class="anchored" data-anchor-id="two-way-ancova"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.3</strong></span> Two-way ANCOVA</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Two-Way%20ANOVA.jpg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Two-Way ANOVA</figcaption><p></p>
</figure>
</div>
</center>
<section id="question-1" class="level3">
<h3 class="anchored" data-anchor-id="question-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.3.1</strong></span> Question</h3>
<p>Previous experiments have shown that both genotype and sex of an organism affect body weight gain. However, a scientist believes that after adjusting for <u>age</u>, there was no significant difference in means of <u>weight</u> gain between groups at different levels of <u>sex</u> and <u>Genotype</u>. Can experiments support this claim?</p>
<ul>
<li>Independent variables:
<ul>
<li>genotype (categorical)</li>
<li>sex (categorical)</li>
<li>age (covariate)</li>
</ul></li>
<li>Dependent variable:
<ul>
<li>Weight gain (continuous)</li>
</ul></li>
</ul>
</section>
<section id="model" class="level3">
<h3 class="anchored" data-anchor-id="model"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.3.2</strong></span> Model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb315"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a>Gain <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"data/Gain.txt"</span>, <span class="at">header =</span> T)</span>
<span id="cb315-2"><a href="#cb315-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Gain, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Weight  Sex Age Genotype Score
1 7.445630 male   1   CloneA     4
2 8.000223 male   2   CloneA     4
3 7.705105 male   3   CloneA     4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb317"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Weight <span class="sc">~</span> Sex <span class="sc">*</span> Age <span class="sc">*</span> Genotype, <span class="at">data =</span> Gain)</span>
<span id="cb317-2"><a href="#cb317-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Weight ~ Sex * Age * Genotype, data = Gain)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40218 -0.12043 -0.01065  0.12592  0.44687 

Coefficients:
                           Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                 7.80053    0.24941  31.276  &lt; 2e-16 ***
Sexmale                    -0.51966    0.35272  -1.473  0.14936    
Age                         0.34950    0.07520   4.648 4.39e-05 ***
GenotypeCloneB              1.19870    0.35272   3.398  0.00167 ** 
GenotypeCloneC             -0.41751    0.35272  -1.184  0.24429    
GenotypeCloneD              0.95600    0.35272   2.710  0.01023 *  
GenotypeCloneE             -0.81604    0.35272  -2.314  0.02651 *  
GenotypeCloneF              1.66851    0.35272   4.730 3.41e-05 ***
Sexmale:Age                -0.11283    0.10635  -1.061  0.29579    
Sexmale:GenotypeCloneB     -0.31716    0.49882  -0.636  0.52891    
Sexmale:GenotypeCloneC     -1.06234    0.49882  -2.130  0.04010 *  
Sexmale:GenotypeCloneD     -0.73547    0.49882  -1.474  0.14906    
Sexmale:GenotypeCloneE     -0.28533    0.49882  -0.572  0.57087    
Sexmale:GenotypeCloneF     -0.19839    0.49882  -0.398  0.69319    
Age:GenotypeCloneB         -0.10146    0.10635  -0.954  0.34643    
Age:GenotypeCloneC         -0.20825    0.10635  -1.958  0.05799 .  
Age:GenotypeCloneD         -0.01757    0.10635  -0.165  0.86970    
Age:GenotypeCloneE         -0.03825    0.10635  -0.360  0.72123    
Age:GenotypeCloneF         -0.05512    0.10635  -0.518  0.60743    
Sexmale:Age:GenotypeCloneB  0.15469    0.15040   1.029  0.31055    
Sexmale:Age:GenotypeCloneC  0.35322    0.15040   2.349  0.02446 *  
Sexmale:Age:GenotypeCloneD  0.19227    0.15040   1.278  0.20929    
Sexmale:Age:GenotypeCloneE  0.13203    0.15040   0.878  0.38585    
Sexmale:Age:GenotypeCloneF  0.08709    0.15040   0.579  0.56616    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2378 on 36 degrees of freedom
Multiple R-squared:  0.9742,    Adjusted R-squared:  0.9577 
F-statistic: 59.06 on 23 and 36 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<ul>
<li>There are no things like Age:Sex or Age:Genotype, so the slope of weight gain against age does not vary with sex or genotype</li>
<li>In the final minimal adequate model, three main effects were included (Sex, Age, Genotype), so it can be considered that there are intercept differences between gender, age and genotype (intercepts vary).</li>
<li>The final minimal adequate model includes three main effects (Sex, Age, Genotype), but no interaction effect. This means that the effects of these variables are independent and there is no interaction between them.</li>
</ul>
</section>
<section id="one-step-1" class="level3">
<h3 class="anchored" data-anchor-id="one-step-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.3.3</strong></span> One step</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb319"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">step</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=-155.01
Weight ~ Sex * Age * Genotype

                   Df Sum of Sq    RSS     AIC
- Sex:Age:Genotype  5   0.34912 2.3849 -155.51
&lt;none&gt;                          2.0358 -155.01

Step:  AIC=-155.51
Weight ~ Sex + Age + Genotype + Sex:Age + Sex:Genotype + Age:Genotype

               Df Sum of Sq    RSS     AIC
- Sex:Genotype  5  0.146901 2.5318 -161.92
- Age:Genotype  5  0.168136 2.5531 -161.42
- Sex:Age       1  0.048937 2.4339 -156.29
&lt;none&gt;                      2.3849 -155.51

Step:  AIC=-161.92
Weight ~ Sex + Age + Genotype + Sex:Age + Age:Genotype

               Df Sum of Sq    RSS     AIC
- Age:Genotype  5  0.168136 2.7000 -168.07
- Sex:Age       1  0.048937 2.5808 -162.78
&lt;none&gt;                      2.5318 -161.92

Step:  AIC=-168.07
Weight ~ Sex + Age + Genotype + Sex:Age

           Df Sum of Sq    RSS      AIC
- Sex:Age   1     0.049  2.749 -168.989
&lt;none&gt;                   2.700 -168.066
- Genotype  5    54.958 57.658    5.612

Step:  AIC=-168.99
Weight ~ Sex + Age + Genotype

           Df Sum of Sq    RSS      AIC
&lt;none&gt;                   2.749 -168.989
- Sex       1    10.374 13.122  -77.201
- Age       1    10.770 13.519  -75.415
- Genotype  5    54.958 57.707    3.662</code></pre>
</div>
<div class="sourceCode cell-code" id="cb321"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Weight ~ Sex + Age + Genotype, data = Gain)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40005 -0.15120 -0.01668  0.16953  0.49227 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     7.93701    0.10066  78.851  &lt; 2e-16 ***
Sexmale        -0.83161    0.05937 -14.008  &lt; 2e-16 ***
Age             0.29958    0.02099  14.273  &lt; 2e-16 ***
GenotypeCloneB  0.96778    0.10282   9.412 8.07e-13 ***
GenotypeCloneC -1.04361    0.10282 -10.149 6.21e-14 ***
GenotypeCloneD  0.82396    0.10282   8.013 1.21e-10 ***
GenotypeCloneE -0.87540    0.10282  -8.514 1.98e-11 ***
GenotypeCloneF  1.53460    0.10282  14.925  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2299 on 52 degrees of freedom
Multiple R-squared:  0.9651,    Adjusted R-squared:  0.9604 
F-statistic: 205.7 on 7 and 52 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>From the above output, we can see the coefficients of each genotype and their corresponding significance level (in the Estimate column). It can be observed that GenotypeCloneC and GenotypeCloneE have similar effects on the dependent variable, with coefficients close to -1 and very small significance levels (p-value &lt; 0.001). Therefore, we can combine these two factors into one factor, reducing the number of genotype levels from six to five. The same approach can be applied to B and D.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb323"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check</span></span>
<span id="cb323-2"><a href="#cb323-2" aria-hidden="true" tabindex="-1"></a>newGenotype <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Gain<span class="sc">$</span>Genotype)</span>
<span id="cb323-3"><a href="#cb323-3" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(newGenotype)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "CloneA" "CloneB" "CloneC" "CloneD" "CloneE" "CloneF"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb325"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Change</span></span>
<span id="cb325-2"><a href="#cb325-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(newGenotype)[<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>)] <span class="ot">&lt;-</span> <span class="st">"ClonesCandE"</span></span>
<span id="cb325-3"><a href="#cb325-3" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(newGenotype)[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>)] <span class="ot">&lt;-</span> <span class="st">"ClonesBandD"</span></span>
<span id="cb325-4"><a href="#cb325-4" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(newGenotype)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "CloneA"      "ClonesBandD" "ClonesCandE" "CloneF"     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb327"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Liner regression &amp; compare</span></span>
<span id="cb327-2"><a href="#cb327-2" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Weight <span class="sc">~</span> Sex <span class="sc">+</span> Age <span class="sc">+</span> newGenotype, <span class="at">data =</span> Gain)</span>
<span id="cb327-3"><a href="#cb327-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m2,m3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: Weight ~ Sex + Age + Genotype
Model 2: Weight ~ Sex + Age + newGenotype
  Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)
1     52 2.7489                           
2     54 2.9938 -2  -0.24489 2.3163 0.1087</code></pre>
</div>
</div>
<details>
<summary>
Analysis of RSS above
</summary>
In regression models, the residual sum of squares (RSS) represents the unexplained variance in the dependent variable. In this example, the RSS for Model 1 and Model 2 are 2.7489 and 2.9938 respectively. The goal of a model is to minimize RSS because it represents how well the model fits with observed values. Generally, a smaller RSS indicates a better fit for the model. When comparing two models’ fit, one can use both RSS and F-statistic. In this example, although Model 2 has a slightly larger RSS than Model 1, its P-value for F-statistic is 0.1087 which does not reach commonly used significance levels such as 0.05; therefore we cannot reject null hypothesis that Model 2 performs worse than Model 1.
</details>
</section>
<section id="result-1" class="level3">
<h3 class="anchored" data-anchor-id="result-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.3.4</strong></span> Result</h3>
<p>As <span class="math inline">\(p=0.1087\)</span>, there is no significant difference between the two models. Therefore, the new model uses NewGenotype (four levels) instead of Genotype (six levels).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb329"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Weight ~ Sex + Age + newGenotype, data = Gain)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.42651 -0.16687  0.01211  0.18776  0.47736 

Coefficients:
                       Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)             7.93701    0.10308  76.996  &lt; 2e-16 ***
Sexmale                -0.83161    0.06080 -13.679  &lt; 2e-16 ***
Age                     0.29958    0.02149  13.938  &lt; 2e-16 ***
newGenotypeClonesBandD  0.89587    0.09119   9.824 1.28e-13 ***
newGenotypeClonesCandE -0.95950    0.09119 -10.522 1.10e-14 ***
newGenotypeCloneF       1.53460    0.10530  14.574  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2355 on 54 degrees of freedom
Multiple R-squared:  0.962, Adjusted R-squared:  0.9585 
F-statistic: 273.7 on 5 and 54 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb331"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb331-1"><a href="#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting formulas from linear regression models</span></span>
<span id="cb331-2"><a href="#cb331-2" aria-hidden="true" tabindex="-1"></a>equatiomatic<span class="sc">::</span><span class="fu">extract_eq</span>(m3, <span class="at">use_coefs =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><span class="math display">\[
\operatorname{\widehat{Weight}} = 7.94 - 0.83(\operatorname{Sex}_{\operatorname{male}}) + 0.3(\operatorname{Age}) + 0.9(\operatorname{newGenotype}_{\operatorname{ClonesBandD}}) - 0.96(\operatorname{newGenotype}_{\operatorname{ClonesCandE}}) + 1.53(\operatorname{newGenotype}_{\operatorname{CloneF}})
\]</span></p>
</div>
<div class="sourceCode cell-code" id="cb332"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a diagnostic statistical data text table</span></span>
<span id="cb332-2"><a href="#cb332-2" aria-hidden="true" tabindex="-1"></a>stargazer<span class="sc">::</span><span class="fu">stargazer</span>(m3, <span class="at">type =</span> <span class="st">'text'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
==================================================
                           Dependent variable:    
                       ---------------------------
                                 Weight           
--------------------------------------------------
Sexmale                         -0.832***         
                                 (0.061)          
                                                  
Age                             0.300***          
                                 (0.021)          
                                                  
newGenotypeClonesBandD          0.896***          
                                 (0.091)          
                                                  
newGenotypeClonesCandE          -0.960***         
                                 (0.091)          
                                                  
newGenotypeCloneF               1.535***          
                                 (0.105)          
                                                  
Constant                        7.937***          
                                 (0.103)          
                                                  
--------------------------------------------------
Observations                       60             
R2                                0.962           
Adjusted R2                       0.959           
Residual Std. Error          0.235 (df = 54)      
F Statistic              273.652*** (df = 5; 54)  
==================================================
Note:                  *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
<p><a href="#diagnostic%20statistical%20data%20text%20table">The meaning of each parameter in this table</a></p>
</section>
<section id="visualization" class="level3">
<h3 class="anchored" data-anchor-id="visualization"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.3.5</strong></span> Visualization</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb334"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb334-1"><a href="#cb334-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Weight<span class="sc">~</span>Age,<span class="at">data=</span>Gain,<span class="at">type=</span><span class="st">"n"</span>)</span>
<span id="cb334-2"><a href="#cb334-2" aria-hidden="true" tabindex="-1"></a>colours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"green"</span>,<span class="st">"red"</span>,<span class="st">"black"</span>,<span class="st">"blue"</span>)</span>
<span id="cb334-3"><a href="#cb334-3" aria-hidden="true" tabindex="-1"></a>lines <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb334-4"><a href="#cb334-4" aria-hidden="true" tabindex="-1"></a>symbols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">16</span>,<span class="dv">17</span>)</span>
<span id="cb334-5"><a href="#cb334-5" aria-hidden="true" tabindex="-1"></a>NewSex<span class="ot">&lt;-</span><span class="fu">as.factor</span>(Gain<span class="sc">$</span>Sex)</span>
<span id="cb334-6"><a href="#cb334-6" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(Weight<span class="sc">~</span>Age,<span class="at">data=</span>Gain,<span class="at">pch=</span>symbols[<span class="fu">as.numeric</span>(NewSex)],</span>
<span id="cb334-7"><a href="#cb334-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span>colours[<span class="fu">as.numeric</span>(newGenotype)])</span>
<span id="cb334-8"><a href="#cb334-8" aria-hidden="true" tabindex="-1"></a>xv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>)</span>
<span id="cb334-9"><a href="#cb334-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>) {</span>
<span id="cb334-10"><a href="#cb334-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb334-11"><a href="#cb334-11" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span> <span class="fu">coef</span>(m3)[<span class="dv">1</span>]<span class="sc">+</span>(i<span class="sc">&gt;</span><span class="dv">1</span>)<span class="sc">*</span> <span class="fu">coef</span>(m3)[<span class="dv">2</span>]<span class="sc">+</span>(j<span class="sc">&gt;</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">coef</span>(m3)[j<span class="sc">+</span><span class="dv">2</span>]</span>
<span id="cb334-12"><a href="#cb334-12" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb334-13"><a href="#cb334-13" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">&lt;-</span> <span class="fu">coef</span>(m3)[<span class="dv">3</span>]</span>
<span id="cb334-14"><a href="#cb334-14" aria-hidden="true" tabindex="-1"></a>    yv <span class="ot">&lt;-</span> a<span class="sc">+</span>b<span class="sc">*</span>xv</span>
<span id="cb334-15"><a href="#cb334-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines</span>(xv,yv,<span class="at">lty=</span>lines[i],<span class="at">col=</span>colours[j]) } }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="mancova" class="level1">
<h1><span style="color:gray; font-family:Microsoft JhengHei;"><strong>10</strong></span> MANCOVA</h1>
</section>
<section id="sessioninfo" class="level1">
<h1><span style="color:green">SessionInfo:</span></h1>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.2.3 (2023-03-15 ucrt)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 19044)

Matrix products: default

locale:
[1] LC_COLLATE=Chinese (Simplified)_China.utf8 
[2] LC_CTYPE=Chinese (Simplified)_China.utf8   
[3] LC_MONETARY=Chinese (Simplified)_China.utf8
[4] LC_NUMERIC=C                               
[5] LC_TIME=Chinese (Simplified)_China.utf8    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] biotools_4.2       mvnormalTest_1.0.0 rstatix_0.7.2      MASS_7.3-58.2     
 [5] gplots_3.1.3       agricolae_1.3-5    openair_2.16-0     lubridate_1.9.2   
 [9] forcats_1.0.0      stringr_1.5.0      dplyr_1.1.0        purrr_1.0.1       
[13] readr_2.1.4        tibble_3.1.8       tidyverse_2.0.0    latex2exp_0.9.6   
[17] patchwork_1.1.2    ggplot2_3.4.1      Epi_2.47           tidyr_1.3.0       
[21] magrittr_2.0.3     knitr_1.42        

loaded via a namespace (and not attached):
 [1] colorspace_2.1-0    deldir_1.0-6        ellipsis_0.3.2     
 [4] rstudioapi_0.14     farver_2.1.1        hexbin_1.28.3      
 [7] gsl_2.1-8           fansi_1.0.3         mvtnorm_1.1-3      
[10] splines_4.2.3       jsonlite_1.8.4      broom_1.0.3        
[13] cluster_2.1.4       png_0.1-8           stabledist_0.7-1   
[16] copula_1.1-2        shiny_1.7.4         mapproj_1.2.11     
[19] compiler_4.2.3      backports_1.4.1     Matrix_1.5-3       
[22] fastmap_1.1.0       cli_3.6.1           later_1.3.0        
[25] htmltools_0.5.4     tools_4.2.3         gtable_0.3.3       
[28] glue_1.6.2          maps_3.4.1          Rcpp_1.0.10        
[31] carData_3.0-5       vctrs_0.5.2         nlme_3.1-162       
[34] stargazer_5.2.3     xfun_0.37           timechange_0.2.0   
[37] mime_0.12           miniUI_0.1.1.1      lifecycle_1.0.3    
[40] gtools_3.9.4        zoo_1.8-11          scales_1.2.1       
[43] hms_1.1.2           promises_1.2.0.1    parallel_4.2.3     
[46] RColorBrewer_1.1-3  yaml_2.3.7          labelled_2.10.0    
[49] latticeExtra_0.6-30 stringi_1.7.12      highr_0.10         
[52] klaR_1.7-2          AlgDesign_1.2.1     pcaPP_2.0-3        
[55] nortest_1.0-4       caTools_1.18.2      boot_1.3-28.1      
[58] rlang_1.1.0         pkgconfig_2.0.3     moments_0.14.1     
[61] bitops_1.0-7        evaluate_0.20       lattice_0.20-45    
[64] htmlwidgets_1.6.1   labeling_0.4.2      cmprsk_2.2-11      
[67] tidyselect_1.2.0    plyr_1.8.8          R6_2.5.1           
[70] generics_0.1.3      combinat_0.0-8      ADGofTest_0.3      
[73] pillar_1.8.1        haven_2.5.1         withr_2.5.0        
[76] mgcv_1.8-42         survival_3.5-3      abind_1.4-5        
[79] pspline_1.0-19      etm_1.1.1           car_3.1-1          
[82] questionr_0.7.8     interp_1.1-3        KernSmooth_2.23-20 
[85] utf8_1.2.3          tzdb_0.3.0          rmarkdown_2.21     
[88] equatiomatic_0.3.1  jpeg_0.1-10         grid_4.2.3         
[91] data.table_1.14.8   digest_0.6.31       xtable_1.8-4       
[94] httpuv_1.6.9        numDeriv_2016.8-1.1 stats4_4.2.3       
[97] munsell_0.5.0      </code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>